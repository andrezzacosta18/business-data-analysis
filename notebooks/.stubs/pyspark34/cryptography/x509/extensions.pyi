import abc
import datetime
import typing
from _typeshed import Incomplete
from cryptography import utils as utils
from cryptography.hazmat.bindings._rust import asn1 as asn1
from cryptography.hazmat.primitives import constant_time as constant_time, serialization as serialization
from cryptography.hazmat.primitives.asymmetric.ec import EllipticCurvePublicKey as EllipticCurvePublicKey
from cryptography.hazmat.primitives.asymmetric.rsa import RSAPublicKey as RSAPublicKey
from cryptography.hazmat.primitives.asymmetric.types import CertificateIssuerPublicKeyTypes as CertificateIssuerPublicKeyTypes, CertificatePublicKeyTypes as CertificatePublicKeyTypes
from cryptography.x509.certificate_transparency import SignedCertificateTimestamp as SignedCertificateTimestamp
from cryptography.x509.general_name import DNSName as DNSName, DirectoryName as DirectoryName, GeneralName as GeneralName, IPAddress as IPAddress, OtherName as OtherName, RFC822Name as RFC822Name, RegisteredID as RegisteredID, UniformResourceIdentifier as UniformResourceIdentifier, _IPAddressTypes
from cryptography.x509.name import Name as Name, RelativeDistinguishedName as RelativeDistinguishedName
from cryptography.x509.oid import CRLEntryExtensionOID as CRLEntryExtensionOID, ExtensionOID as ExtensionOID, OCSPExtensionOID as OCSPExtensionOID, ObjectIdentifier as ObjectIdentifier

ExtensionTypeVar = typing.TypeVar('ExtensionTypeVar', bound='ExtensionType', covariant=True)

class DuplicateExtension(Exception):
    oid: Incomplete
    def __init__(self, msg: str, oid: ObjectIdentifier) -> None: ...

class ExtensionNotFound(Exception):
    oid: Incomplete
    def __init__(self, msg: str, oid: ObjectIdentifier) -> None: ...

class ExtensionType(metaclass=abc.ABCMeta):
    oid: typing.ClassVar[ObjectIdentifier]
    def public_bytes(self) -> bytes:
        """
        Serializes the extension type to DER.
        """

class Extensions:
    def __init__(self, extensions: typing.Iterable[Extension[ExtensionType]]) -> None: ...
    def get_extension_for_oid(self, oid: ObjectIdentifier) -> Extension[ExtensionType]: ...
    def get_extension_for_class(self, extclass: typing.Type[ExtensionTypeVar]) -> Extension[ExtensionTypeVar]: ...
    __len__: Incomplete
    __iter__: Incomplete
    __getitem__: Incomplete

class CRLNumber(ExtensionType):
    oid: Incomplete
    def __init__(self, crl_number: int) -> None: ...
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    @property
    def crl_number(self) -> int: ...
    def public_bytes(self) -> bytes: ...

class AuthorityKeyIdentifier(ExtensionType):
    oid: Incomplete
    def __init__(self, key_identifier: bytes | None, authority_cert_issuer: typing.Iterable[GeneralName] | None, authority_cert_serial_number: int | None) -> None: ...
    @classmethod
    def from_issuer_public_key(cls, public_key: CertificateIssuerPublicKeyTypes) -> AuthorityKeyIdentifier: ...
    @classmethod
    def from_issuer_subject_key_identifier(cls, ski: SubjectKeyIdentifier) -> AuthorityKeyIdentifier: ...
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    @property
    def key_identifier(self) -> bytes | None: ...
    @property
    def authority_cert_issuer(self) -> typing.List[GeneralName] | None: ...
    @property
    def authority_cert_serial_number(self) -> int | None: ...
    def public_bytes(self) -> bytes: ...

class SubjectKeyIdentifier(ExtensionType):
    oid: Incomplete
    def __init__(self, digest: bytes) -> None: ...
    @classmethod
    def from_public_key(cls, public_key: CertificatePublicKeyTypes) -> SubjectKeyIdentifier: ...
    @property
    def digest(self) -> bytes: ...
    @property
    def key_identifier(self) -> bytes: ...
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    def public_bytes(self) -> bytes: ...

class AuthorityInformationAccess(ExtensionType):
    oid: Incomplete
    def __init__(self, descriptions: typing.Iterable[AccessDescription]) -> None: ...
    __len__: Incomplete
    __iter__: Incomplete
    __getitem__: Incomplete
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    def public_bytes(self) -> bytes: ...

class SubjectInformationAccess(ExtensionType):
    oid: Incomplete
    def __init__(self, descriptions: typing.Iterable[AccessDescription]) -> None: ...
    __len__: Incomplete
    __iter__: Incomplete
    __getitem__: Incomplete
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    def public_bytes(self) -> bytes: ...

class AccessDescription:
    def __init__(self, access_method: ObjectIdentifier, access_location: GeneralName) -> None: ...
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    @property
    def access_method(self) -> ObjectIdentifier: ...
    @property
    def access_location(self) -> GeneralName: ...

class BasicConstraints(ExtensionType):
    oid: Incomplete
    def __init__(self, ca: bool, path_length: int | None) -> None: ...
    @property
    def ca(self) -> bool: ...
    @property
    def path_length(self) -> int | None: ...
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    def public_bytes(self) -> bytes: ...

class DeltaCRLIndicator(ExtensionType):
    oid: Incomplete
    def __init__(self, crl_number: int) -> None: ...
    @property
    def crl_number(self) -> int: ...
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    def public_bytes(self) -> bytes: ...

class CRLDistributionPoints(ExtensionType):
    oid: Incomplete
    def __init__(self, distribution_points: typing.Iterable[DistributionPoint]) -> None: ...
    __len__: Incomplete
    __iter__: Incomplete
    __getitem__: Incomplete
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    def public_bytes(self) -> bytes: ...

class FreshestCRL(ExtensionType):
    oid: Incomplete
    def __init__(self, distribution_points: typing.Iterable[DistributionPoint]) -> None: ...
    __len__: Incomplete
    __iter__: Incomplete
    __getitem__: Incomplete
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    def public_bytes(self) -> bytes: ...

class DistributionPoint:
    def __init__(self, full_name: typing.Iterable[GeneralName] | None, relative_name: RelativeDistinguishedName | None, reasons: typing.FrozenSet[ReasonFlags] | None, crl_issuer: typing.Iterable[GeneralName] | None) -> None: ...
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    @property
    def full_name(self) -> typing.List[GeneralName] | None: ...
    @property
    def relative_name(self) -> RelativeDistinguishedName | None: ...
    @property
    def reasons(self) -> typing.FrozenSet[ReasonFlags] | None: ...
    @property
    def crl_issuer(self) -> typing.List[GeneralName] | None: ...

class ReasonFlags(utils.Enum):
    unspecified: str
    key_compromise: str
    ca_compromise: str
    affiliation_changed: str
    superseded: str
    cessation_of_operation: str
    certificate_hold: str
    privilege_withdrawn: str
    aa_compromise: str
    remove_from_crl: str

class PolicyConstraints(ExtensionType):
    oid: Incomplete
    def __init__(self, require_explicit_policy: int | None, inhibit_policy_mapping: int | None) -> None: ...
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    @property
    def require_explicit_policy(self) -> int | None: ...
    @property
    def inhibit_policy_mapping(self) -> int | None: ...
    def public_bytes(self) -> bytes: ...

class CertificatePolicies(ExtensionType):
    oid: Incomplete
    def __init__(self, policies: typing.Iterable[PolicyInformation]) -> None: ...
    __len__: Incomplete
    __iter__: Incomplete
    __getitem__: Incomplete
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    def public_bytes(self) -> bytes: ...

class PolicyInformation:
    def __init__(self, policy_identifier: ObjectIdentifier, policy_qualifiers: typing.Iterable[str | UserNotice] | None) -> None: ...
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    @property
    def policy_identifier(self) -> ObjectIdentifier: ...
    @property
    def policy_qualifiers(self) -> typing.List[str | UserNotice] | None: ...

class UserNotice:
    def __init__(self, notice_reference: NoticeReference | None, explicit_text: str | None) -> None: ...
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    @property
    def notice_reference(self) -> NoticeReference | None: ...
    @property
    def explicit_text(self) -> str | None: ...

class NoticeReference:
    def __init__(self, organization: str | None, notice_numbers: typing.Iterable[int]) -> None: ...
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    @property
    def organization(self) -> str | None: ...
    @property
    def notice_numbers(self) -> typing.List[int]: ...

class ExtendedKeyUsage(ExtensionType):
    oid: Incomplete
    def __init__(self, usages: typing.Iterable[ObjectIdentifier]) -> None: ...
    __len__: Incomplete
    __iter__: Incomplete
    __getitem__: Incomplete
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    def public_bytes(self) -> bytes: ...

class OCSPNoCheck(ExtensionType):
    oid: Incomplete
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    def public_bytes(self) -> bytes: ...

class PrecertPoison(ExtensionType):
    oid: Incomplete
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    def public_bytes(self) -> bytes: ...

class TLSFeature(ExtensionType):
    oid: Incomplete
    def __init__(self, features: typing.Iterable[TLSFeatureType]) -> None: ...
    __len__: Incomplete
    __iter__: Incomplete
    __getitem__: Incomplete
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    def public_bytes(self) -> bytes: ...

class TLSFeatureType(utils.Enum):
    status_request: int
    status_request_v2: int

class InhibitAnyPolicy(ExtensionType):
    oid: Incomplete
    def __init__(self, skip_certs: int) -> None: ...
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    @property
    def skip_certs(self) -> int: ...
    def public_bytes(self) -> bytes: ...

class KeyUsage(ExtensionType):
    oid: Incomplete
    def __init__(self, digital_signature: bool, content_commitment: bool, key_encipherment: bool, data_encipherment: bool, key_agreement: bool, key_cert_sign: bool, crl_sign: bool, encipher_only: bool, decipher_only: bool) -> None: ...
    @property
    def digital_signature(self) -> bool: ...
    @property
    def content_commitment(self) -> bool: ...
    @property
    def key_encipherment(self) -> bool: ...
    @property
    def data_encipherment(self) -> bool: ...
    @property
    def key_agreement(self) -> bool: ...
    @property
    def key_cert_sign(self) -> bool: ...
    @property
    def crl_sign(self) -> bool: ...
    @property
    def encipher_only(self) -> bool: ...
    @property
    def decipher_only(self) -> bool: ...
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    def public_bytes(self) -> bytes: ...

class NameConstraints(ExtensionType):
    oid: Incomplete
    def __init__(self, permitted_subtrees: typing.Iterable[GeneralName] | None, excluded_subtrees: typing.Iterable[GeneralName] | None) -> None: ...
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    @property
    def permitted_subtrees(self) -> typing.List[GeneralName] | None: ...
    @property
    def excluded_subtrees(self) -> typing.List[GeneralName] | None: ...
    def public_bytes(self) -> bytes: ...

class Extension(typing.Generic[ExtensionTypeVar]):
    def __init__(self, oid: ObjectIdentifier, critical: bool, value: ExtensionTypeVar) -> None: ...
    @property
    def oid(self) -> ObjectIdentifier: ...
    @property
    def critical(self) -> bool: ...
    @property
    def value(self) -> ExtensionTypeVar: ...
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...

class GeneralNames:
    def __init__(self, general_names: typing.Iterable[GeneralName]) -> None: ...
    __len__: Incomplete
    __iter__: Incomplete
    __getitem__: Incomplete
    @typing.overload
    def get_values_for_type(self, type: typing.Type[DNSName] | typing.Type[UniformResourceIdentifier] | typing.Type[RFC822Name]) -> typing.List[str]: ...
    @typing.overload
    def get_values_for_type(self, type: typing.Type[DirectoryName]) -> typing.List[Name]: ...
    @typing.overload
    def get_values_for_type(self, type: typing.Type[RegisteredID]) -> typing.List[ObjectIdentifier]: ...
    @typing.overload
    def get_values_for_type(self, type: typing.Type[IPAddress]) -> typing.List[_IPAddressTypes]: ...
    @typing.overload
    def get_values_for_type(self, type: typing.Type[OtherName]) -> typing.List[OtherName]: ...
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...

class SubjectAlternativeName(ExtensionType):
    oid: Incomplete
    def __init__(self, general_names: typing.Iterable[GeneralName]) -> None: ...
    __len__: Incomplete
    __iter__: Incomplete
    __getitem__: Incomplete
    @typing.overload
    def get_values_for_type(self, type: typing.Type[DNSName] | typing.Type[UniformResourceIdentifier] | typing.Type[RFC822Name]) -> typing.List[str]: ...
    @typing.overload
    def get_values_for_type(self, type: typing.Type[DirectoryName]) -> typing.List[Name]: ...
    @typing.overload
    def get_values_for_type(self, type: typing.Type[RegisteredID]) -> typing.List[ObjectIdentifier]: ...
    @typing.overload
    def get_values_for_type(self, type: typing.Type[IPAddress]) -> typing.List[_IPAddressTypes]: ...
    @typing.overload
    def get_values_for_type(self, type: typing.Type[OtherName]) -> typing.List[OtherName]: ...
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    def public_bytes(self) -> bytes: ...

class IssuerAlternativeName(ExtensionType):
    oid: Incomplete
    def __init__(self, general_names: typing.Iterable[GeneralName]) -> None: ...
    __len__: Incomplete
    __iter__: Incomplete
    __getitem__: Incomplete
    @typing.overload
    def get_values_for_type(self, type: typing.Type[DNSName] | typing.Type[UniformResourceIdentifier] | typing.Type[RFC822Name]) -> typing.List[str]: ...
    @typing.overload
    def get_values_for_type(self, type: typing.Type[DirectoryName]) -> typing.List[Name]: ...
    @typing.overload
    def get_values_for_type(self, type: typing.Type[RegisteredID]) -> typing.List[ObjectIdentifier]: ...
    @typing.overload
    def get_values_for_type(self, type: typing.Type[IPAddress]) -> typing.List[_IPAddressTypes]: ...
    @typing.overload
    def get_values_for_type(self, type: typing.Type[OtherName]) -> typing.List[OtherName]: ...
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    def public_bytes(self) -> bytes: ...

class CertificateIssuer(ExtensionType):
    oid: Incomplete
    def __init__(self, general_names: typing.Iterable[GeneralName]) -> None: ...
    __len__: Incomplete
    __iter__: Incomplete
    __getitem__: Incomplete
    @typing.overload
    def get_values_for_type(self, type: typing.Type[DNSName] | typing.Type[UniformResourceIdentifier] | typing.Type[RFC822Name]) -> typing.List[str]: ...
    @typing.overload
    def get_values_for_type(self, type: typing.Type[DirectoryName]) -> typing.List[Name]: ...
    @typing.overload
    def get_values_for_type(self, type: typing.Type[RegisteredID]) -> typing.List[ObjectIdentifier]: ...
    @typing.overload
    def get_values_for_type(self, type: typing.Type[IPAddress]) -> typing.List[_IPAddressTypes]: ...
    @typing.overload
    def get_values_for_type(self, type: typing.Type[OtherName]) -> typing.List[OtherName]: ...
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    def public_bytes(self) -> bytes: ...

class CRLReason(ExtensionType):
    oid: Incomplete
    def __init__(self, reason: ReasonFlags) -> None: ...
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    @property
    def reason(self) -> ReasonFlags: ...
    def public_bytes(self) -> bytes: ...

class InvalidityDate(ExtensionType):
    oid: Incomplete
    def __init__(self, invalidity_date: datetime.datetime) -> None: ...
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    @property
    def invalidity_date(self) -> datetime.datetime: ...
    def public_bytes(self) -> bytes: ...

class PrecertificateSignedCertificateTimestamps(ExtensionType):
    oid: Incomplete
    def __init__(self, signed_certificate_timestamps: typing.Iterable[SignedCertificateTimestamp]) -> None: ...
    __len__: Incomplete
    __iter__: Incomplete
    __getitem__: Incomplete
    def __hash__(self) -> int: ...
    def __eq__(self, other: object) -> bool: ...
    def public_bytes(self) -> bytes: ...

class SignedCertificateTimestamps(ExtensionType):
    oid: Incomplete
    def __init__(self, signed_certificate_timestamps: typing.Iterable[SignedCertificateTimestamp]) -> None: ...
    __len__: Incomplete
    __iter__: Incomplete
    __getitem__: Incomplete
    def __hash__(self) -> int: ...
    def __eq__(self, other: object) -> bool: ...
    def public_bytes(self) -> bytes: ...

class OCSPNonce(ExtensionType):
    oid: Incomplete
    def __init__(self, nonce: bytes) -> None: ...
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    @property
    def nonce(self) -> bytes: ...
    def public_bytes(self) -> bytes: ...

class OCSPAcceptableResponses(ExtensionType):
    oid: Incomplete
    def __init__(self, responses: typing.Iterable[ObjectIdentifier]) -> None: ...
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    def __iter__(self) -> typing.Iterator[ObjectIdentifier]: ...
    def public_bytes(self) -> bytes: ...

class IssuingDistributionPoint(ExtensionType):
    oid: Incomplete
    def __init__(self, full_name: typing.Iterable[GeneralName] | None, relative_name: RelativeDistinguishedName | None, only_contains_user_certs: bool, only_contains_ca_certs: bool, only_some_reasons: typing.FrozenSet[ReasonFlags] | None, indirect_crl: bool, only_contains_attribute_certs: bool) -> None: ...
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    @property
    def full_name(self) -> typing.List[GeneralName] | None: ...
    @property
    def relative_name(self) -> RelativeDistinguishedName | None: ...
    @property
    def only_contains_user_certs(self) -> bool: ...
    @property
    def only_contains_ca_certs(self) -> bool: ...
    @property
    def only_some_reasons(self) -> typing.FrozenSet[ReasonFlags] | None: ...
    @property
    def indirect_crl(self) -> bool: ...
    @property
    def only_contains_attribute_certs(self) -> bool: ...
    def public_bytes(self) -> bytes: ...

class MSCertificateTemplate(ExtensionType):
    oid: Incomplete
    def __init__(self, template_id: ObjectIdentifier, major_version: int | None, minor_version: int | None) -> None: ...
    @property
    def template_id(self) -> ObjectIdentifier: ...
    @property
    def major_version(self) -> int | None: ...
    @property
    def minor_version(self) -> int | None: ...
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    def public_bytes(self) -> bytes: ...

class UnrecognizedExtension(ExtensionType):
    def __init__(self, oid: ObjectIdentifier, value: bytes) -> None: ...
    @property
    def oid(self) -> ObjectIdentifier: ...
    @property
    def value(self) -> bytes: ...
    def __eq__(self, other: object) -> bool: ...
    def __hash__(self) -> int: ...
    def public_bytes(self) -> bytes: ...
