import typing
from cryptography import utils as utils
from cryptography.exceptions import InvalidSignature as InvalidSignature
from cryptography.hazmat.primitives import hashes as hashes, padding as padding
from cryptography.hazmat.primitives.ciphers import Cipher as Cipher, algorithms as algorithms, modes as modes
from cryptography.hazmat.primitives.hmac import HMAC as HMAC

class InvalidToken(Exception): ...

class Fernet:
    def __init__(self, key: bytes | str, backend: typing.Any = None) -> None: ...
    @classmethod
    def generate_key(cls) -> bytes: ...
    def encrypt(self, data: bytes) -> bytes: ...
    def encrypt_at_time(self, data: bytes, current_time: int) -> bytes: ...
    def decrypt(self, token: bytes | str, ttl: int | None = None) -> bytes: ...
    def decrypt_at_time(self, token: bytes | str, ttl: int, current_time: int) -> bytes: ...
    def extract_timestamp(self, token: bytes | str) -> int: ...

class MultiFernet:
    def __init__(self, fernets: typing.Iterable[Fernet]) -> None: ...
    def encrypt(self, msg: bytes) -> bytes: ...
    def encrypt_at_time(self, msg: bytes, current_time: int) -> bytes: ...
    def rotate(self, msg: bytes | str) -> bytes: ...
    def decrypt(self, msg: bytes | str, ttl: int | None = None) -> bytes: ...
    def decrypt_at_time(self, msg: bytes | str, ttl: int, current_time: int) -> bytes: ...
