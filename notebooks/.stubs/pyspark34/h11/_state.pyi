from ._events import *
from ._util import Sentinel
from _typeshed import Incomplete
from typing import Dict, Tuple, Type

__all__ = ['CLIENT', 'SERVER', 'IDLE', 'SEND_RESPONSE', 'SEND_BODY', 'DONE', 'MUST_CLOSE', 'CLOSED', 'MIGHT_SWITCH_PROTOCOL', 'SWITCHED_PROTOCOL', 'ERROR']

class CLIENT(Sentinel, metaclass=Sentinel): ...
class SERVER(Sentinel, metaclass=Sentinel): ...
class IDLE(Sentinel, metaclass=Sentinel): ...
class SEND_RESPONSE(Sentinel, metaclass=Sentinel): ...
class SEND_BODY(Sentinel, metaclass=Sentinel): ...
class DONE(Sentinel, metaclass=Sentinel): ...
class MUST_CLOSE(Sentinel, metaclass=Sentinel): ...
class CLOSED(Sentinel, metaclass=Sentinel): ...
class ERROR(Sentinel, metaclass=Sentinel): ...
class MIGHT_SWITCH_PROTOCOL(Sentinel, metaclass=Sentinel): ...
class SWITCHED_PROTOCOL(Sentinel, metaclass=Sentinel): ...
class _SWITCH_UPGRADE(Sentinel, metaclass=Sentinel): ...
class _SWITCH_CONNECT(Sentinel, metaclass=Sentinel): ...
EventTransitionType = Dict[Type[Sentinel], Dict[Type[Sentinel], Dict[Type[Event] | Tuple[Type[Event], Type[Sentinel]], Type[Sentinel]]]]
StateTransitionType = Dict[Tuple[Type[Sentinel], Type[Sentinel]], Dict[Type[Sentinel], Type[Sentinel]]]

class ConnectionState:
    keep_alive: bool
    pending_switch_proposals: Incomplete
    states: Incomplete
    def __init__(self) -> None: ...
    def process_error(self, role: Type[Sentinel]) -> None: ...
    def process_keep_alive_disabled(self) -> None: ...
    def process_client_switch_proposal(self, switch_event: Type[Sentinel]) -> None: ...
    def process_event(self, role: Type[Sentinel], event_type: Type[Event], server_switch_event: Type[Sentinel] | None = None) -> None: ...
    def start_next_cycle(self) -> None: ...
