import typing
from _typeshed import Incomplete
from starlette._utils import is_async_callable as is_async_callable
from starlette.exceptions import HTTPException as HTTPException
from starlette.requests import HTTPConnection as HTTPConnection, Request as Request
from starlette.responses import RedirectResponse as RedirectResponse, Response as Response
from starlette.websockets import WebSocket as WebSocket

def has_required_scope(conn: HTTPConnection, scopes: typing.Sequence[str]) -> bool: ...
def requires(scopes: str | typing.Sequence[str], status_code: int = 403, redirect: str | None = None) -> typing.Callable[[_CallableType], _CallableType]: ...

class AuthenticationError(Exception): ...

class AuthenticationBackend:
    async def authenticate(self, conn: HTTPConnection) -> typing.Tuple['AuthCredentials', 'BaseUser'] | None: ...

class AuthCredentials:
    scopes: Incomplete
    def __init__(self, scopes: typing.Sequence[str] | None = None) -> None: ...

class BaseUser:
    @property
    def is_authenticated(self) -> bool: ...
    @property
    def display_name(self) -> str: ...
    @property
    def identity(self) -> str: ...

class SimpleUser(BaseUser):
    username: Incomplete
    def __init__(self, username: str) -> None: ...
    @property
    def is_authenticated(self) -> bool: ...
    @property
    def display_name(self) -> str: ...

class UnauthenticatedUser(BaseUser):
    @property
    def is_authenticated(self) -> bool: ...
    @property
    def display_name(self) -> str: ...
