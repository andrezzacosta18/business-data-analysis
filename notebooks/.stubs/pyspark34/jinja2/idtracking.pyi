import typing as t
from . import nodes as nodes
from .visitor import NodeVisitor as NodeVisitor
from _typeshed import Incomplete

VAR_LOAD_PARAMETER: str
VAR_LOAD_RESOLVE: str
VAR_LOAD_ALIAS: str
VAR_LOAD_UNDEFINED: str

def find_symbols(nodes: t.Iterable[nodes.Node], parent_symbols: Symbols | None = None) -> Symbols: ...
def symbols_for_node(node: nodes.Node, parent_symbols: Symbols | None = None) -> Symbols: ...

class Symbols:
    level: Incomplete
    parent: Incomplete
    refs: Incomplete
    loads: Incomplete
    stores: Incomplete
    def __init__(self, parent: Symbols | None = None, level: int | None = None) -> None: ...
    def analyze_node(self, node: nodes.Node, **kwargs: t.Any) -> None: ...
    def find_load(self, target: str) -> t.Any | None: ...
    def find_ref(self, name: str) -> str | None: ...
    def ref(self, name: str) -> str: ...
    def copy(self) -> Symbols: ...
    def store(self, name: str) -> None: ...
    def declare_parameter(self, name: str) -> str: ...
    def load(self, name: str) -> None: ...
    def branch_update(self, branch_symbols: t.Sequence['Symbols']) -> None: ...
    def dump_stores(self) -> t.Dict[str, str]: ...
    def dump_param_targets(self) -> t.Set[str]: ...

class RootVisitor(NodeVisitor):
    sym_visitor: Incomplete
    def __init__(self, symbols: Symbols) -> None: ...
    visit_Template: Incomplete
    visit_Block: Incomplete
    visit_Macro: Incomplete
    visit_FilterBlock: Incomplete
    visit_Scope: Incomplete
    visit_If: Incomplete
    visit_ScopedEvalContextModifier: Incomplete
    def visit_AssignBlock(self, node: nodes.AssignBlock, **kwargs: t.Any) -> None: ...
    def visit_CallBlock(self, node: nodes.CallBlock, **kwargs: t.Any) -> None: ...
    def visit_OverlayScope(self, node: nodes.OverlayScope, **kwargs: t.Any) -> None: ...
    def visit_For(self, node: nodes.For, for_branch: str = 'body', **kwargs: t.Any) -> None: ...
    def visit_With(self, node: nodes.With, **kwargs: t.Any) -> None: ...
    def generic_visit(self, node: nodes.Node, *args: t.Any, **kwargs: t.Any) -> None: ...

class FrameSymbolVisitor(NodeVisitor):
    """A visitor for `Frame.inspect`."""
    symbols: Incomplete
    def __init__(self, symbols: Symbols) -> None: ...
    def visit_Name(self, node: nodes.Name, store_as_param: bool = False, **kwargs: t.Any) -> None:
        """All assignments to names go through this function."""
    def visit_NSRef(self, node: nodes.NSRef, **kwargs: t.Any) -> None: ...
    def visit_If(self, node: nodes.If, **kwargs: t.Any) -> None: ...
    def visit_Macro(self, node: nodes.Macro, **kwargs: t.Any) -> None: ...
    def visit_Import(self, node: nodes.Import, **kwargs: t.Any) -> None: ...
    def visit_FromImport(self, node: nodes.FromImport, **kwargs: t.Any) -> None: ...
    def visit_Assign(self, node: nodes.Assign, **kwargs: t.Any) -> None:
        """Visit assignments in the correct order."""
    def visit_For(self, node: nodes.For, **kwargs: t.Any) -> None:
        """Visiting stops at for blocks.  However the block sequence
        is visited as part of the outer scope.
        """
    def visit_CallBlock(self, node: nodes.CallBlock, **kwargs: t.Any) -> None: ...
    def visit_FilterBlock(self, node: nodes.FilterBlock, **kwargs: t.Any) -> None: ...
    def visit_With(self, node: nodes.With, **kwargs: t.Any) -> None: ...
    def visit_AssignBlock(self, node: nodes.AssignBlock, **kwargs: t.Any) -> None:
        """Stop visiting at block assigns."""
    def visit_Scope(self, node: nodes.Scope, **kwargs: t.Any) -> None:
        """Stop visiting at scopes."""
    def visit_Block(self, node: nodes.Block, **kwargs: t.Any) -> None:
        """Stop visiting at blocks."""
    def visit_OverlayScope(self, node: nodes.OverlayScope, **kwargs: t.Any) -> None:
        """Do not visit into overlay scopes."""
