from .util import fc as fc
from _typeshed import Incomplete

class Pd:
    """
    A particular probability distribution
    """
    def flatparam(self) -> None: ...
    def mode(self) -> None: ...
    def neglogp(self, x) -> None: ...
    def kl(self, other) -> None: ...
    def entropy(self) -> None: ...
    def sample(self) -> None: ...
    def logp(self, x): ...
    def get_shape(self): ...
    @property
    def shape(self): ...
    def __getitem__(self, idx): ...

class PdType:
    """
    Parametrized family of probability distributions
    """
    def pdclass(self) -> None: ...
    def pdfromflat(self, flat, mask, nsteps, size, is_act_model): ...
    def pdfromlatent(self, latent_vector, init_scale, init_bias) -> None: ...
    def param_shape(self) -> None: ...
    def sample_shape(self) -> None: ...
    def sample_dtype(self) -> None: ...
    def param_placeholder(self, prepend_shape, name: Incomplete | None = None): ...
    def sample_placeholder(self, prepend_shape, name: Incomplete | None = None): ...

class CategoricalPd(Pd):
    """
    Categorical probability distribution
    """
    logits: Incomplete
    mask_npinf: Incomplete
    nsteps: Incomplete
    size: Incomplete
    is_act_model: Incomplete
    def __init__(self, logits, mask_npinf, nsteps, size, is_act_model) -> None: ...
    def flatparam(self): ...
    def mode(self): ...
    @property
    def mean(self): ...
    def neglogp(self, x):
        """
        return tf.nn.sparse_softmax_cross_entropy_with_logits(logits=self.logits, labels=x)
        Note: we can't use sparse_softmax_cross_entropy_with_logits because
              the implementation does not allow second-order derivatives...
        """
    def kl(self, other):
        """kl"""
    def entropy(self):
        """compute entropy"""
    def sample(self):
        """sample from logits"""
    @classmethod
    def fromflat(cls, flat): ...

class CategoricalPdType(PdType):
    """
    To create CategoricalPd
    """
    ncat: Incomplete
    nsteps: Incomplete
    np_mask: Incomplete
    is_act_model: Incomplete
    def __init__(self, ncat, nsteps, np_mask, is_act_model) -> None: ...
    def pdclass(self): ...
    def pdfromlatent(self, latent_vector, init_scale: float = 1.0, init_bias: float = 0.0):
        """add fc and create CategoricalPd"""
    def param_shape(self): ...
    def sample_shape(self): ...
    def sample_dtype(self): ...
