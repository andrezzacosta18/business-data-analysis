import torch.nn as nn
from .choice import InputChoice as InputChoice, LayerChoice as LayerChoice, Placeholder as Placeholder, ValueChoice as ValueChoice, ValueChoiceX as ValueChoiceX
from _typeshed import Incomplete
from nni.common.serializer import is_traceable as is_traceable, is_wrapped_with_trace as is_wrapped_with_trace
from nni.nas.execution.common.graph import Evaluator as Evaluator, Graph as Graph, Model as Model, ModelStatus as ModelStatus, Node as Node
from nni.nas.execution.common.graph_op import Cell as Cell
from nni.nas.hub.pytorch.modules import NasBench101Cell as NasBench101Cell, NasBench101Mutator as NasBench101Mutator
from nni.nas.mutable import Mutator as Mutator
from nni.nas.utils import ModelNamespace as ModelNamespace, is_basic_unit as is_basic_unit, is_model_wrapped as is_model_wrapped, uid as uid
from typing import Any, List, Tuple

class LayerChoiceMutator(Mutator):
    nodes: Incomplete
    def __init__(self, nodes: List[Node]) -> None: ...
    def mutate(self, model) -> None: ...

class InputChoiceMutator(Mutator):
    nodes: Incomplete
    def __init__(self, nodes: List[Node]) -> None: ...
    def mutate(self, model) -> None: ...

class ValueChoiceMutator(Mutator):
    nodes: Incomplete
    candidates: Incomplete
    def __init__(self, nodes: List[Node], candidates: List[Any]) -> None: ...
    def mutate(self, model) -> None: ...

class ParameterChoiceLeafMutator(Mutator):
    candidates: Incomplete
    def __init__(self, candidates: List[Any], label: str) -> None: ...
    def mutate(self, model: Model) -> None: ...

class ParameterChoiceMutator(Mutator):
    nodes: Incomplete
    def __init__(self, nodes: List[Tuple[Node, str]]) -> None: ...
    def mutate(self, model: Model) -> None: ...

class RepeatMutator(Mutator):
    nodes: Incomplete
    def __init__(self, nodes: List[Node]) -> None: ...
    def mutate(self, model) -> None: ...

def process_inline_mutation(model: Model) -> List[Mutator] | None: ...

class ManyChooseManyMutator(Mutator):
    """
    Choose based on labels. Will not affect the model itself.
    """
    def __init__(self, label: str) -> None: ...
    @staticmethod
    def candidates(node): ...
    @staticmethod
    def number_of_chosen(node): ...
    def mutate(self, model: Model) -> None: ...

def extract_mutation_from_pt_module(pytorch_model: nn.Module) -> Tuple[Model, List[Mutator] | None]: ...

class EvaluatorValueChoiceLeafMutator(Mutator):
    candidates: Incomplete
    def __init__(self, candidates: List[Any], label: str) -> None: ...
    def mutate(self, model: Model) -> None: ...

class EvaluatorValueChoiceMutator(Mutator):
    def mutate(self, model: Model) -> None: ...

def process_evaluator_mutations(evaluator: Evaluator, existing_mutators: List[Mutator]) -> List[Mutator]: ...
def process_oneshot_mutations(base_model: nn.Module, evaluator: Evaluator): ...
