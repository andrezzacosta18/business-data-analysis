import gym
import numpy as np
import torch.nn as nn
from .utils import get_targeted_model as get_targeted_model
from _typeshed import Incomplete
from nni.nas.execution import submit_models as submit_models, wait_models as wait_models
from nni.nas.execution.common import ModelStatus as ModelStatus
from tianshou.env.worker import EnvWorker
from typing import Tuple
from typing_extensions import TypedDict

class MultiThreadEnvWorker(EnvWorker):
    env: Incomplete
    pool: Incomplete
    def __init__(self, env_fn) -> None: ...
    def get_env_attr(self, key): ...
    def set_env_attr(self, key, value): ...
    def __getattr__(self, key): ...
    def reset(self): ...
    result: Incomplete
    def send(self, action) -> None: ...
    def recv(self): ...
    @staticmethod
    def wait(*args, **kwargs) -> None: ...
    def send_action(self, action) -> None: ...
    def get_result(self): ...
    def seed(self, seed): ...
    def render(self, **kwargs): ...
    def close_env(self) -> None: ...

class ObservationType(TypedDict):
    action_history: np.ndarray
    cur_step: int
    action_dim: int

class ModelEvaluationEnv(gym.Env[ObservationType, int]):
    base_model: Incomplete
    mutators: Incomplete
    search_space: Incomplete
    ss_keys: Incomplete
    action_dim: Incomplete
    num_steps: Incomplete
    def __init__(self, base_model, mutators, search_space) -> None: ...
    @property
    def observation_space(self): ...
    @property
    def action_space(self): ...
    action_history: Incomplete
    cur_step: int
    sample: Incomplete
    def reset(self) -> ObservationType: ...
    def step(self, action: int) -> Tuple[ObservationType, float, bool, dict]: ...

class Preprocessor(nn.Module):
    action_dim: Incomplete
    hidden_dim: Incomplete
    embedding: Incomplete
    rnn: Incomplete
    def __init__(self, obs_space, hidden_dim: int = 64, num_layers: int = 1) -> None: ...
    def forward(self, obs): ...

class Actor(nn.Module):
    preprocess: Incomplete
    action_dim: Incomplete
    linear: Incomplete
    def __init__(self, action_space, preprocess) -> None: ...
    def forward(self, obs, **kwargs): ...

class Critic(nn.Module):
    preprocess: Incomplete
    linear: Incomplete
    def __init__(self, preprocess) -> None: ...
    def forward(self, obs, **kwargs): ...
