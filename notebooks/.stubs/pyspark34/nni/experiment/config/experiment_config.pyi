from . import utils
from .algorithm import _AlgorithmConfig
from .base import ConfigBase
from .shared_storage import SharedStorageConfig
from .training_service import TrainingServiceConfig
from _typeshed import Incomplete
from dataclasses import dataclass
from typing import Any, List
from typing_extensions import Literal

__all__ = ['ExperimentConfig']

@dataclass(init=False)
class ExperimentConfig(ConfigBase):
    """
    Class of experiment configuration. Check the reference_ for explaination of each field.

    When used in Python experiment API, it can be constructed in two favors:

    1. Create an empty project then set each field

    .. code-block:: python

        config = ExperimentConfig('local')
        config.search_space = {...}
        config.tuner.name = 'random'
        config.training_service.use_active_gpu = True

     2. Use kwargs directly

     .. code-block:: python

        config = ExperimentConfig(
            search_space = {...},
            tuner = AlgorithmConfig(name='random'),
            training_service = LocalConfig(
                use_active_gpu = True
            )
        )

    .. _reference: https://nni.readthedocs.io/en/stable/reference/experiment_config.html
    """
    experiment_name: str | None = ...
    experiment_type: Literal['hpo'] = ...
    search_space_file: utils.PathLike | None = ...
    search_space: Any = ...
    trial_command: str | None = ...
    trial_code_directory: utils.PathLike = ...
    trial_concurrency: int
    trial_gpu_number: int | None = ...
    max_experiment_duration: str | int | None = ...
    max_trial_number: int | None = ...
    max_trial_duration: str | int | None = ...
    nni_manager_ip: str | None = ...
    use_annotation: bool = ...
    debug: bool = ...
    log_level: str | None = ...
    experiment_working_directory: utils.PathLike = ...
    tuner_gpu_indices: List[int] | int | str | None = ...
    tuner: _AlgorithmConfig | None = ...
    assessor: _AlgorithmConfig | None = ...
    advisor: _AlgorithmConfig | None = ...
    training_service: TrainingServiceConfig | List[TrainingServiceConfig]
    shared_storage: SharedStorageConfig | None = ...
    def __init__(self, training_service_platform: Incomplete | None = None, **kwargs) -> None: ...
