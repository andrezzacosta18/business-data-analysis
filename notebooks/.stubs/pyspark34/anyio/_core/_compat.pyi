from ._testing import TaskInfo as TaskInfo
from _typeshed import Incomplete
from abc import ABCMeta, abstractmethod
from types import TracebackType
from typing import AsyncContextManager, Callable, ContextManager, Generator, Generic, Iterable, List, TypeVar, overload

T = TypeVar('T')
AnyDeprecatedAwaitable: Incomplete

@overload
async def maybe_async(__obj: TaskInfo) -> TaskInfo: ...
@overload
async def maybe_async(__obj: DeprecatedAwaitableFloat) -> float: ...
@overload
async def maybe_async(__obj: DeprecatedAwaitableList[T]) -> list[T]: ...
@overload
async def maybe_async(__obj: DeprecatedAwaitable) -> None: ...

class _ContextManagerWrapper:
    def __init__(self, cm: ContextManager[T]) -> None: ...
    async def __aenter__(self) -> T: ...
    async def __aexit__(self, exc_type: type[BaseException] | None, exc_val: BaseException | None, exc_tb: TracebackType | None) -> bool | None: ...

def maybe_async_cm(cm: ContextManager[T] | AsyncContextManager[T]) -> AsyncContextManager[T]:
    """
    Wrap a regular context manager as an async one if necessary.

    This function is intended to bridge the gap between AnyIO 2.x and 3.x where some functions and
    methods were changed to return regular context managers instead of async ones.

    :param cm: a regular or async context manager
    :return: an async context manager

    .. versionadded:: 2.2

    """

class DeprecatedAwaitable:
    def __init__(self, func: Callable[..., DeprecatedAwaitable]) -> None: ...
    def __await__(self) -> Generator[None, None, None]: ...
    def __reduce__(self) -> tuple[type[None], tuple]: ...

class DeprecatedAwaitableFloat(float):
    def __new__(cls, x: float, func: Callable[..., DeprecatedAwaitableFloat]) -> DeprecatedAwaitableFloat: ...
    def __init__(self, x: float, func: Callable[..., DeprecatedAwaitableFloat]) -> None: ...
    def __await__(self) -> Generator[None, None, float]: ...
    def __reduce__(self) -> tuple[type[float], tuple[float]]: ...

class DeprecatedAwaitableList(List[T]):
    def __init__(self, iterable: Iterable[T] = (), *, func: Callable[..., DeprecatedAwaitableList[T]]) -> None: ...
    def __await__(self) -> Generator[None, None, list[T]]: ...
    def __reduce__(self) -> tuple[type[list[T]], tuple[list[T]]]: ...

class DeprecatedAsyncContextManager(Generic[T], metaclass=ABCMeta):
    @abstractmethod
    def __enter__(self) -> T: ...
    @abstractmethod
    def __exit__(self, exc_type: type[BaseException] | None, exc_val: BaseException | None, exc_tb: TracebackType | None) -> bool | None: ...
    async def __aenter__(self) -> T: ...
    async def __aexit__(self, exc_type: type[BaseException] | None, exc_val: BaseException | None, exc_tb: TracebackType | None) -> bool | None: ...
