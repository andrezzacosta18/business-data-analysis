from _typeshed import Incomplete
from mlflow.environment_variables import MLFLOW_TRACKING_URI as MLFLOW_TRACKING_URI
from mlflow.exceptions import MlflowException as MlflowException
from mlflow.utils.rest_utils import MlflowHostCreds as MlflowHostCreds
from mlflow.utils.uri import get_db_info_from_uri as get_db_info_from_uri, is_databricks_uri as is_databricks_uri
from typing import TypeVar

def get_mlflow_credential_context_by_run_id(run_id): ...

class MlflowCredentialContext:
    """Sets and clears credentials on a context using the provided profile URL."""
    databricks_profile_url: Incomplete
    db_utils: Incomplete
    def __init__(self, databricks_profile_url) -> None: ...
    def __enter__(self) -> None: ...
    def __exit__(self, exc_type: type[BaseException] | None, exc_value: BaseException | None, exc_traceback: types.TracebackType | None) -> None: ...

class _NoDbutilsError(Exception): ...

def acl_path_of_acl_root(): ...
def is_databricks_default_tracking_uri(tracking_uri): ...
def is_in_databricks_notebook(): ...
def is_in_databricks_job(): ...
def is_in_databricks_repo(): ...
def is_in_databricks_repo_notebook(): ...
def is_in_databricks_runtime(): ...
def is_dbfs_fuse_available(): ...
def is_in_cluster(): ...
def get_notebook_id():
    """Should only be called if is_in_databricks_notebook is true"""
def get_notebook_path():
    """Should only be called if is_in_databricks_notebook is true"""
def get_databricks_runtime(): ...
def get_cluster_id(): ...
def get_job_group_id(): ...
def get_repl_id():
    """
    :return: The ID of the current Databricks Python REPL
    """
def get_job_id(): ...
def get_job_run_id(): ...
def get_job_type():
    """Should only be called if is_in_databricks_job is true"""
def get_job_type_info(): ...
def get_command_run_id(): ...
def get_webapp_url():
    """Should only be called if is_in_databricks_notebook or is_in_databricks_jobs is true"""
def get_workspace_id(): ...
def get_browser_hostname(): ...
def get_workspace_info_from_dbutils(): ...
def get_workspace_url(): ...
def warn_on_deprecated_cross_workspace_registry_uri(registry_uri) -> None: ...
def get_workspace_info_from_databricks_secrets(tracking_uri): ...
def get_databricks_host_creds(server_uri: Incomplete | None = None):
    '''
    Reads in configuration necessary to make HTTP requests to a Databricks server. This
    uses the Databricks CLI\'s ConfigProvider interface to load the DatabricksConfig object.
    If no Databricks CLI profile is found corresponding to the server URI, this function
    will attempt to retrieve these credentials from the Databricks Secret Manager. For that to work,
    the server URI will need to be of the following format: "databricks://scope:prefix". In the
    Databricks Secret Manager, we will query for a secret in the scope "<scope>" for secrets with
    keys of the form "<prefix>-host" and "<prefix>-token". Note that this prefix *cannot* be empty
    if trying to authenticate with this method. If found, those host credentials will be used. This
    method will throw an exception if sufficient auth cannot be found.

    :param server_uri: A URI that specifies the Databricks profile you want to use for making
    requests.
    :return: :py:class:`mlflow.rest_utils.MlflowHostCreds` which includes the hostname and
        authentication information necessary to talk to the Databricks server.
    '''
def get_git_repo_url(): ...
def get_git_repo_provider(): ...
def get_git_repo_commit(): ...
def get_git_repo_relative_path(): ...
def get_git_repo_reference(): ...
def get_git_repo_reference_type(): ...
def get_git_repo_status(): ...
def is_running_in_ipython_environment(): ...
def get_databricks_run_url(tracking_uri: str, run_id: str, artifact_path: Incomplete | None = None) -> str | None:
    """
    Obtains a Databricks URL corresponding to the specified MLflow Run, optionally referring
    to an artifact within the run.

    :param tracking_uri: The URI of the MLflow Tracking server containing the Run.
    :param run_id: The ID of the MLflow Run for which to obtain a Databricks URL.
    :param artifact_path: An optional relative artifact path within the Run to which the URL
                          should refer.
    :return: A Databricks URL corresponding to the specified MLflow Run
             (and artifact path, if specified), or None if the MLflow Run does not belong to a
             Databricks Workspace.
    """
def get_databricks_model_version_url(registry_uri: str, name: str, version: str) -> str | None:
    """
    Obtains a Databricks URL corresponding to the specified Model Version.

    :param tracking_uri: The URI of the Model Registry server containing the Model Version.
    :param name: The name of the registered model containing the Model Version.
    :param version: Version number of the Model Version.
    :return: A Databricks URL corresponding to the specified Model Version, or None if the
             Model Version does not belong to a Databricks Workspace.
    """
DatabricksWorkspaceInfoType = TypeVar('DatabricksWorkspaceInfo', bound='DatabricksWorkspaceInfo')

class DatabricksWorkspaceInfo:
    WORKSPACE_HOST_ENV_VAR: str
    WORKSPACE_ID_ENV_VAR: str
    host: Incomplete
    workspace_id: Incomplete
    def __init__(self, host: str, workspace_id: str | None = None) -> None: ...
    @classmethod
    def from_environment(cls) -> DatabricksWorkspaceInfoType | None: ...
    def to_environment(self): ...

def get_databricks_workspace_info_from_uri(tracking_uri: str) -> DatabricksWorkspaceInfo | None: ...
def check_databricks_secret_scope_access(scope_name) -> None: ...
def get_databricks_env_vars(tracking_uri): ...
