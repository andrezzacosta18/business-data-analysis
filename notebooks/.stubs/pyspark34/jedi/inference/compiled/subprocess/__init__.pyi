from _typeshed import Incomplete
from jedi import debug as debug
from jedi._compatibility import pickle_dump as pickle_dump, pickle_load as pickle_load
from jedi.api.exceptions import InternalError as InternalError
from jedi.cache import memoize_method as memoize_method
from jedi.inference.compiled.access import AccessPath as AccessPath, DirectObjectAccess as DirectObjectAccess, SignatureParam as SignatureParam
from jedi.inference.compiled.subprocess import functions as functions

PICKLE_PROTOCOL: int

class _InferenceStateProcess:
    def __init__(self, inference_state) -> None: ...
    def get_or_create_access_handle(self, obj): ...
    def get_access_handle(self, id_): ...
    def set_access_handle(self, handle) -> None: ...

class InferenceStateSameProcess(_InferenceStateProcess):
    """
    Basically just an easy access to functions.py. It has the same API
    as InferenceStateSubprocess and does the same thing without using a subprocess.
    This is necessary for the Interpreter process.
    """
    def __getattr__(self, name): ...

class InferenceStateSubprocess(_InferenceStateProcess):
    def __init__(self, inference_state, compiled_subprocess) -> None: ...
    def __getattr__(self, name): ...
    def __del__(self) -> None: ...

class CompiledSubprocess:
    is_crashed: bool
    def __init__(self, executable, env_vars: Incomplete | None = None) -> None: ...
    def run(self, inference_state, function, args=(), kwargs={}): ...
    def get_sys_path(self): ...
    def delete_inference_state(self, inference_state_id) -> None:
        """
        Currently we are not deleting inference_state instantly. They only get
        deleted once the subprocess is used again. It would probably a better
        solution to move all of this into a thread. However, the memory usage
        of a single inference_state shouldn't be that high.
        """

class Listener:
    def __init__(self) -> None: ...
    def listen(self) -> None: ...

class AccessHandle:
    access: Incomplete
    id: Incomplete
    def __init__(self, subprocess, access, id_) -> None: ...
    def add_subprocess(self, subprocess) -> None: ...
    def __getattr__(self, name): ...
