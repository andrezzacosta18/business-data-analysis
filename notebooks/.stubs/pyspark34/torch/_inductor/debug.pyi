import torch
from . import config as config, ir as ir
from .scheduler import BaseSchedulerNode as BaseSchedulerNode, FusedSchedulerNode as FusedSchedulerNode, NopKernelSchedulerNode as NopKernelSchedulerNode, OutputNode as OutputNode, SchedulerNode as SchedulerNode
from .virtualized import V as V
from _typeshed import Incomplete
from collections.abc import Generator
from torch import fx as fx
from torch._dynamo.debug_utils import save_graph_repro as save_graph_repro, wrap_compiler_debug as wrap_compiler_debug
from torch._dynamo.utils import get_debug_dir as get_debug_dir, init_logging as init_logging
from torch.fx.graph_module import GraphModule as GraphModule
from torch.fx.passes.shape_prop import TensorMetadata as TensorMetadata
from torch.fx.passes.tools_common import legalize_graph as legalize_graph
from typing import Any, List

log: Incomplete

def has_dot(): ...
def draw_buffers(nodes, print_graph: bool = False, fname: Incomplete | None = None) -> None:
    """
    Draw a graph in fname.svg.
    nodes is a list of SchedulerNode objects.
    """
def create_fx_from_snodes(snodes: List[BaseSchedulerNode]) -> fx.Graph:
    """
    Creates a FX Graph from a list of SchedulerNode objects.
    """
def enable_aot_logging() -> Generator[None, None, Incomplete]: ...

class DebugContext:
    @staticmethod
    def wrap(fn): ...
    @staticmethod
    def create_debug_dir(folder_name): ...
    def __init__(self) -> None: ...
    def rename(self, new_path: str): ...
    def fopen(self, filename): ...
    def filename(self, suffix): ...
    def upload_tar(self) -> None: ...
    def __enter__(self) -> None: ...
    def __exit__(self, exc_type: type[BaseException] | None, exc_val: BaseException | None, exc_tb: types.TracebackType | None) -> None: ...
    def __getattr__(self, name): ...
SchedulerNodeList = List[Any]

class DebugFormatter:
    fopen: Incomplete
    filename: Incomplete
    handler: Incomplete
    def __init__(self, handler) -> None: ...
    def fx_graph(self, gm: torch.fx.GraphModule, inputs: List[torch.Tensor]): ...
    def fx_graph_transformed(self, gm: torch.fx.GraphModule, inputs: List[torch.Tensor]): ...
    def ir_pre_fusion(self, nodes: SchedulerNodeList): ...
    def ir_post_fusion(self, nodes: SchedulerNodeList): ...
    def graph_diagram(self, nodes: SchedulerNodeList): ...
    def output_code(self, filename) -> None: ...
