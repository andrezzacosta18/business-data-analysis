import abc
from torch import Tensor as Tensor
from torch.distributed.rpc import RRef as RRef
from torch.testing._internal.dist_utils import dist_init as dist_init, wait_until_pending_futures_and_users_flushed as wait_until_pending_futures_and_users_flushed, worker_name as worker_name
from torch.testing._internal.distributed.rpc.rpc_agent_test_fixture import RpcAgentTestFixture as RpcAgentTestFixture
from typing import Dict, Tuple

def two_args_two_kwargs(first_arg, second_arg, first_kwarg=..., second_kwarg=...): ...
def script_rpc_async_call(dst_worker_name: str, args: Tuple[Tensor, Tensor], kwargs: Dict[str, Tensor]): ...
def rpc_async_call_with_timeout(dst_worker_name: str, args: Tuple[Tensor, Tensor], kwargs: Dict[str, Tensor], timeout: float): ...
def rpc_async_call_with_timeout_future_ret(dst_worker_name: str, args: Tuple[Tensor, Tensor], kwargs: Dict[str, Tensor], timeout: float): ...
def rpc_async_call_future_ret(dst_worker_name: str, args: Tuple[Tensor, Tensor], kwargs: Dict[str, Tensor]): ...
def rref_to_here(rref_var: RRef[Tensor]) -> Tensor: ...
def rref_to_here_with_timeout(rref_var: RRef[Tensor], timeout: float) -> Tensor: ...
def rpc_async_with_rref_arg(dst_worker_name: str, args: Tuple[RRef[Tensor]]) -> Tensor: ...

class JitFaultyAgentRpcTest(RpcAgentTestFixture, metaclass=abc.ABCMeta):
    """
    Run tests for rpc_async in JIT under the faulty agent test fixture to test
    arbitrary timeouts.
    """
    def test_timeout_in_torchscript_function(self) -> None: ...
    def test_timeout_in_python(self) -> None: ...
    def test_remote_timeout_to_here_in_jit(self) -> None: ...
    def test_rref_to_here_timeout_in_jit(self) -> None: ...
    def test_rref_timeout_pickle_in_jit(self) -> None: ...
    def test_rref_timeout_pickle_script_func(self) -> None: ...
