import abc
import torch
import torch.distributed.rpc as rpc
import torch.nn as nn
from _typeshed import Incomplete
from torch.distributed.rpc import RRef as RRef, WorkerInfo as WorkerInfo
from torch.distributed.rpc.internal import PythonUDF as PythonUDF, RPCExecMode as RPCExecMode
from torch.futures import Future as Future
from torch.testing._internal.common_distributed import captured_output as captured_output, skip_if_lt_x_gpu as skip_if_lt_x_gpu, tp_transports as tp_transports
from torch.testing._internal.common_utils import IS_MACOS as IS_MACOS, TemporaryFileName as TemporaryFileName, get_cycles_per_ms as get_cycles_per_ms, load_tests as load_tests, sandcastle_skip_if as sandcastle_skip_if
from torch.testing._internal.dist_utils import dist_init as dist_init, get_function_event as get_function_event, initialize_pg as initialize_pg, wait_until_node_failure as wait_until_node_failure, wait_until_owners_and_forks_on_rank as wait_until_owners_and_forks_on_rank, wait_until_pending_futures_and_users_flushed as wait_until_pending_futures_and_users_flushed, worker_name as worker_name
from torch.testing._internal.distributed.rpc.rpc_agent_test_fixture import RpcAgentTestFixture as RpcAgentTestFixture
from typing import NamedTuple

def foo_add(): ...
def udf_with_torch_ops(device: int = -1, use_record_function: bool = False) -> None: ...

EXPECTED_REMOTE_EVENTS: Incomplete
REMOTE_OP_STR: str
VALUE_FUTURE: Incomplete
DONE_FUTURE: Incomplete
FIFTY_MIL_CYCLES: int

class StubRpcAgent:
    world_size: Incomplete
    def __init__(self, world_size) -> None: ...
    def get_worker_infos(self): ...

def set_value(value) -> None: ...
def wait_for_value_future(): ...
def set_and_check_done(value): ...

class TensorClass(NamedTuple):
    tensors: Incomplete

class MyPickleClass:
    t: Incomplete
    def __init__(self) -> None: ...
    def set(self, val) -> None: ...

class SlowPickleClass:
    t: Incomplete
    def __init__(self, t) -> None: ...

class MyClass:
    a: Incomplete
    def __init__(self, a, delay: bool = False) -> None: ...
    def my_instance_method(self, b): ...
    @classmethod
    def my_class_method(cls, d, e): ...
    @staticmethod
    def my_static_method(f): ...
    def increment_value(self, increment) -> None: ...
    def get_value(self): ...
    def my_slow_method(self, my_tensor_arg): ...

def get_rref_list(values): ...
def add_rref_to_value(rref, value): ...
def run_nested_pickle(pickle_cls_instance, tensor): ...
def build_sparse_tensor(coalesce: bool = False): ...
def build_complex_tensors(): ...
def non_cont_test(t_view, t_cont): ...
def my_function(a, b, c): ...
def my_tensor_function(a, b): ...
def my_container_sum(a): ...
def my_sleep_func(seconds: int = 1): ...
def my_complex_tensor_function(list_input, tensor_class_input, dict_input): ...
def my_rref_function(rref_a, rref_b): ...
def delayed_add(a, b, seconds: float = 0.05): ...
def identity(a): ...
def no_result() -> None: ...
def raise_or_inc(value): ...
def nested_rpc(dst): ...
def nested_rpc_sparse(dst): ...
def multi_layer_nested_async_rpc(dst, world_size, ttl): ...
def nested_rref(dst): ...
def nested_rref_sparse(dst): ...
def nested_remote(dst): ...
def nested_remote_sparse(dst): ...
def rref_forward_chain(dst, world_size, rref, ttl): ...
def rpc_return_rref(dst): ...
def light_rpc(): ...
def heavy_rpc(tensor): ...
def heavy_rpc_sparse(tensor): ...
def heavy_rpc_torchscript(tensor): ...
def my_script_func(tensor): ...

expected_err: str

class CustomException(Exception):
    bool: Incomplete
    def __init__(self, bool, msg) -> None: ...

def raise_func() -> None: ...
def custom_raise_func() -> None: ...
def raise_func_script(expected_err: str) -> torch.Tensor: ...

expected_err_escape: str

def raise_func_escape() -> None: ...

global_rref: Incomplete

def set_global_rref(rref) -> None: ...
def clear_global_rref() -> None: ...
def check_rref_confirmed(rref): ...
def get_rref_debug_info(): ...
def add_use_future_cb(to, x, y, z): ...
def get_events_from_profile(profile_rref): ...
def add_use_future_set_result(to, x, y, z): ...
def add_use_future_nested_cb(to, x, y, z): ...
def fail_on_fut(fut) -> None: ...
def async_raise_func() -> None: ...
def async_wrong_type(): ...
def async_add(to, x, y): ...
def slow_add(x, y, device: str = 'cpu'): ...
def slow_async_add(to, x, y, device: str = 'cpu'): ...
def async_add_with_future_ctor(to, x, y, z): ...
def async_add_chained(to, x, y, z): ...
def async_add_chained_multi(to, x, num, step): ...
def async_add_nested(to, x, y, z): ...
def async_add_multi_fanout(to, x, num, step): ...
def async_cuda_sleep_and_set_to_one(t): ...
def async_cuda_nested_add(to, x, y, z): ...

class TensorWrapper:
    tensor: Incomplete
    lock: Incomplete
    event: Incomplete
    thread: Incomplete
    def __init__(self, t) -> None: ...
    def increase(self, v) -> None: ...
    def sum(self): ...

class AsyncExecutionClass:
    @staticmethod
    def static_async_add(to, x, y, z): ...
    @classmethod
    def class_async_add(cls, to, x, y, z): ...
    def bound_async_add(self, to, x, y, z): ...

def return_future(): ...

class FooBackendOptions(rpc.RpcBackendOptions):
    init_method: Incomplete
    def __init__(self, init_method) -> None: ...
load_tests = load_tests

class MyEmbeddingBagModel(torch.nn.Module):
    eb: Incomplete
    def __init__(self, sparse) -> None: ...
    def forward(self, x): ...

class MyParameterServer:
    lock: Incomplete
    trainers: Incomplete
    iteration: int
    updates: int
    futures: Incomplete
    total: Incomplete
    gradient: Incomplete
    def __init__(self, trainers) -> None: ...
    @staticmethod
    def get_gradient(rref): ...
    @staticmethod
    def average(rref, riteration, tensor): ...

class MyConvNetForMNIST(nn.Module):
    net: Incomplete
    device: Incomplete
    def __init__(self, device) -> None: ...
    def forward(self, x, is_rref: bool = False): ...

class RpcTestCommon: ...

class RpcTest(RpcAgentTestFixture, RpcTestCommon, metaclass=abc.ABCMeta):
    def test_worker_id(self) -> None: ...
    def test_get_worker_infos(self) -> None: ...
    def test_self_add(self) -> None: ...
    def test_send_to_rank(self) -> None: ...
    def test_self_py_udf_remote(self) -> None: ...
    def test_self_remote_rref_as_rpc_arg(self) -> None: ...
    def test_self_remote_rref_as_self_rpc_arg(self) -> None: ...
    def test_self_remote_rref_as_remote_arg(self) -> None: ...
    def test_self_remote_rref_as_self_remote_arg(self) -> None: ...
    def test_rref_proxy_non_exist(self) -> None: ...
    def test_rref_proxy_tensor(self) -> None: ...
    def test_rref_proxy_tensor_self(self) -> None: ...
    def test_rref_proxy_reuse(self) -> None: ...
    def test_rref_proxy_class(self) -> None: ...
    def test_rref_proxy_class_self(self) -> None: ...
    def test_register_rpc_backend_and_set_and_start_rpc_backend(self, mock_rpc_agent, mock_dist_autograd_init) -> None: ...
    def test_duplicate_name(self) -> None: ...
    def test_duplicate_name_2(self) -> None: ...
    def test_reinit(self) -> None: ...
    lin: Incomplete
    def test_pg_init_no_rpc_init(self): ...
    def test_world_size_one(self) -> None: ...
    def test_invalid_names(self) -> None: ...
    def test_worker_info_pickle(self) -> None: ...
    def test_add(self) -> None: ...
    @staticmethod
    def return_callee_id(): ...
    def test_int_callee(self) -> None: ...
    def test_add_with_id(self) -> None: ...
    def test_scalar_add(self) -> None: ...
    def test_async_add(self) -> None: ...
    def test_nonzero(self) -> None: ...
    def test_multi_rpc(self) -> None: ...
    def test_future_wait_twice(self) -> None: ...
    def test_wait_all_workers_timeout(self) -> None: ...
    def test_wait_all_workers_dense(self) -> None: ...
    def test_wait_all_workers_twice_dense(self) -> None: ...
    def test_all_gather(self) -> None: ...
    def test_all_gather_timeout(self) -> None: ...
    def test_rpc_barrier_all(self) -> None: ...
    def test_rpc_barrier_subset(self) -> None: ...
    def test_rpc_barrier_partial_subset(self) -> None: ...
    def test_rpc_barrier_multithreaded(self) -> None: ...
    def test_graceful_shutdown_with_uneven_workload(self) -> None:
        """Test graceful termination."""
    def test_shutdown_followed_by_rpc(self) -> None: ...
    def test_expected_src(self) -> None: ...
    def test_py_built_in(self) -> None: ...
    def test_py_user_defined(self) -> None: ...
    def test_build_rpc_profiling_key(self) -> None: ...
    def check_profiling_info(self, self_worker_name, dst_worker_name, func, rpc_event, rpc_exec_mode) -> None: ...
    def test_profiler_rpc_record_shapes(self) -> None: ...
    def test_profiler_rpc_memory(self) -> None: ...
    def test_profiler_export_trace(self) -> None: ...
    def test_profiler_rpc_key_names(self) -> None: ...
    def test_profiler_remote_events_profiled(self) -> None: ...
    def test_profiler_remote_events_profiled_single_threaded(self) -> None: ...
    def run_profiling_workload(self, dst) -> None: ...
    def test_rpc_profiling_async_function(self) -> None: ...
    def test_rpc_profiling_async_function_single_threaded(self) -> None: ...
    def test_rpc_profiling_remote_record_function(self): ...
    def validate_profiling_workload(self, dst, prof): ...
    def test_profiler_with_autograd_context_single_threaded(self) -> None: ...
    def test_profiler_with_autograd_context(self) -> None: ...
    def test_profiler_with_sync_rpc_udf(self) -> None: ...
    def test_profiler_with_sync_rpc_udf_single_threaded(self) -> None: ...
    def test_profiler_with_sync_rpc_builtin(self) -> None: ...
    def test_profiler_with_sync_rpc_builtin_single_threaded(self) -> None: ...
    def test_profiler_with_async_rpc_udf(self) -> None: ...
    def test_profiler_with_async_rpc_udf_single_threaded(self) -> None: ...
    def test_profiler_with_async_rpc_builtin(self) -> None: ...
    def test_profiler_with_async_rpc_builtin_single_threaded(self) -> None: ...
    def test_profiler_with_remote_udf(self) -> None: ...
    def test_profiler_with_remote_udf_single_threaded(self) -> None: ...
    def test_profiler_with_remote_builtin(self) -> None: ...
    def test_profiler_with_remote_builtin_single_threaded(self) -> None: ...
    def test_profiler_with_script_async_rpc(self) -> None: ...
    def test_profiler_with_script_async_rpc_single_threaded(self) -> None: ...
    def test_profiler_with_script_sync_rpc(self) -> None: ...
    def test_profiler_with_script_sync_rpc_single_threaded(self) -> None: ...
    def test_profiler_with_script_remote_rpc(self) -> None: ...
    def test_profiler_with_script_remote_rpc_single_threaded(self) -> None: ...
    def test_server_process_global_profiler(self) -> None: ...
    def test_async_record_function_double_end_callbacks(self) -> None: ...
    def test_async_record_function_legacy(self) -> None: ...
    def test_async_record_function_cbs_jit_call(self) -> None: ...
    def test_py_class_constructor(self) -> None: ...
    def test_py_class_instance_method(self) -> None: ...
    def test_py_class_method(self) -> None: ...
    def test_py_class_static_method(self) -> None: ...
    def test_py_multi_async_call(self) -> None: ...
    def test_py_no_return_result(self) -> None: ...
    def test_py_tensors(self) -> None: ...
    def test_py_tensors_multi_async_call(self) -> None: ...
    def test_py_tensors_in_container(self) -> None: ...
    def test_py_nested_pickle(self) -> None: ...
    def test_py_function_exception(self) -> None: ...
    def test_py_raise_in_user_func(self) -> None: ...
    def test_py_raise_in_user_func_escaped_str(self) -> None: ...
    def test_nested_rpc(self) -> None: ...
    def test_stress_light_rpc(self) -> None: ...
    def test_stress_heavy_rpc(self) -> None: ...
    def test_stress_heavy_rpc_torchscript(self) -> None: ...
    def test_builtin_remote_ret(self) -> None: ...
    def test_builtin_remote_self(self) -> None: ...
    def test_multi_builtin_remote_ret(self) -> None: ...
    def test_py_udf_remote(self) -> None: ...
    def test_multi_py_udf_remote(self) -> None: ...
    def test_py_rref_args(self) -> None: ...
    def test_py_rref_args_user_share(self) -> None: ...
    def test_py_rpc_rref_args(self) -> None: ...
    def test_nested_remote(self) -> None: ...
    def test_nested_rref(self) -> None: ...
    def test_nested_rref_stress(self) -> None: ...
    def test_multi_layer_nested_async_rpc(self) -> None: ...
    def test_remote_with_exception(self) -> None: ...
    def test_rpc_return_rref(self) -> None: ...
    def test_rref_forward_chain(self) -> None: ...
    def test_local_rref_no_fork(self) -> None: ...
    def test_local_value_not_on_owner(self) -> None: ...
    def test_return_local_rrefs(self) -> None: ...
    def test_rref_type_blocking(self) -> None: ...
    def test_rref_type_non_blocking(self) -> None: ...
    def test_rref_type_with_error_blocking(self) -> None: ...
    def test_rref_type_with_error_non_blocking(self) -> None: ...
    def test_rref_type_owner_blocking(self) -> None: ...
    def test_rref_type_owner_non_blocking(self) -> None: ...
    def test_rref_type_slow_init(self) -> None: ...
    def test_owner_equality(self) -> None: ...
    def test_pass_local_rrefs(self) -> None: ...
    def test_remote_same_worker(self) -> None: ...
    def test_call_method_on_rref(self) -> None:
        """
        Tests that it is possible to call an instance method on a remote objet
        by using rref.owner() as destination of the call.
        """
    def test_rref_leak(self) -> None: ...
    def test_ignore_rref_leak(self) -> None: ...
    def test_rref_str(self) -> None: ...
    def test_rref_get_future(self) -> None: ...
    def test_rref_context_debug_info(self) -> None: ...
    def test_disable_gil_profiling(self): ...
    def test_local_shutdown(self) -> None: ...
    def test_debug_info(self) -> None: ...
    def test_handle_send_exceptions(self) -> None: ...
    def test_deadlock(self) -> None: ...
    def test_local_shutdown_with_rpc(self) -> None: ...
    def test_set_and_get_default_rpc_timeout(self) -> None: ...
    def test_default_timeout_used(self) -> None:
        """
        Tests that if no timeout is passed into rpc_async and rpc_sync, then the
        default timeout is used.
        """
    def test_rpc_timeouts(self) -> None: ...
    def test_dist_init_decorator(self): ...
    def test_use_rpc_pickler(self) -> None: ...
    def test_wait_all(self) -> None: ...
    def test_wait_all_multiple_call(self) -> None: ...
    def test_wait_all_timeout(self) -> None: ...
    def test_wait_all_raise_in_user_func(self) -> None: ...
    def test_wait_all_raise_in_body(self) -> None: ...
    def test_custom_exception_throw_during_reconstruction(self) -> None:
        """
        Test that we still throw info about the remote side exception even when
        we cannot recreate it on client side.
        """
    timed_out_rpc_event: Incomplete
    @staticmethod
    def timed_out_rpc() -> None: ...
    def test_wait_all_exit_early_python(self) -> None: ...
    def test_wait_all_exit_early_builtin(self) -> None: ...
    def test_wait_all_exit_early_script_function(self) -> None: ...
    def test_function_not_on_callee(self) -> None: ...
    def test_non_garbage_collected_user_rref_due_to_local_circular_dependency(self) -> None: ...
    def test_use_rref_after_shutdown(self) -> None: ...
    def test_user_rrefs_confirmed(self) -> None: ...
    def test_user_rrefs_confirmed_remote(self) -> None: ...
    def test_rref_py_pickle_not_supported(self) -> None: ...
    def test_remote_throw(self) -> None: ...
    def test_non_cont_tensors(self) -> None: ...
    def test_callback_simple(self) -> None: ...
    def test_callback_wrong_arg_num(self) -> None: ...
    def test_callback_wrong_arg_type(self): ...
    def test_callback_multi(self): ...
    def test_callback_chain(self): ...
    def test_callback_in_rpc(self) -> None: ...
    def test_callback_with_ret(self): ...
    def test_callback_with_error(self) -> None: ...
    def test_callback_none(self) -> None: ...
    def test_add_done_callback(self): ...
    def test_mark_future_twice(self) -> None: ...
    def test_pickle_future(self) -> None: ...
    def test_future_done(self) -> None: ...
    def test_future_done_exception(self) -> None: ...
    def test_future_in_rpc(self) -> None: ...
    def test_future_nested_callback(self) -> None: ...
    def test_async_function_raise(self) -> None: ...
    def test_async_function_raise_async(self) -> None: ...
    def test_async_function_raise_remote(self) -> None: ...
    def test_async_function_wrong_return_type(self) -> None: ...
    def test_async_function_wrong_return_type_async(self) -> None: ...
    def test_async_function_wrong_return_type_remote(self) -> None: ...
    def test_async_function_simple(self) -> None: ...
    def test_async_function_with_future_ctor(self) -> None: ...
    def test_async_function_with_future_ctor_remote(self) -> None: ...
    def test_async_function_chained(self) -> None: ...
    def test_async_function_chained_remote(self) -> None: ...
    def test_async_function_nested(self) -> None: ...
    def test_async_function_nested_remote(self) -> None: ...
    def test_async_static_method(self) -> None: ...
    def test_async_static_method_remote(self) -> None: ...
    def test_async_class_method(self) -> None: ...
    def test_async_class_method_remote(self) -> None: ...
    def test_async_class_rref_proxy(self) -> None: ...
    def test_async_class_rref_proxy_async(self) -> None: ...
    def test_async_class_rref_proxy_remote(self) -> None: ...
    def test_async_function_multi_chained(self) -> None: ...
    def test_async_function_multi_chained_async(self) -> None: ...
    def test_async_function_multi_chained_remote(self) -> None: ...
    def test_async_function_multi_fanout(self) -> None: ...
    def test_async_function_multi_fanout_async(self) -> None: ...
    def test_async_function_multi_fanout_remote(self) -> None: ...
    def test_return_future(self) -> None: ...
    def test_return_future_async(self) -> None: ...
    def test_return_future_remote(self) -> None: ...
    def test_rref_timeout(self) -> None: ...
    def test_init_pg_then_rpc(self) -> None: ...
    def test_init_rpc_then_pg(self) -> None: ...
    def test_wait_all_with_exception(self) -> None: ...
    def test_wait_all_with_partial_exception(self) -> None: ...
    def test_init_rpc_twice(self) -> None: ...
    def test_wrong_types(self) -> None: ...
    def test_cannot_infer_backend_from_options(self) -> None: ...
    def test_owner_rref_backward(self) -> None: ...
    def test_user_rref_backward(self) -> None: ...
    def test_shutdown_errors(self) -> None: ...
    def test_my_parameter_server(self) -> None: ...

class CudaRpcTest(RpcAgentTestFixture, metaclass=abc.ABCMeta):
    def test_profiler_remote_cuda(self): ...

class TensorPipeAgentRpcTest(RpcAgentTestFixture, RpcTestCommon, metaclass=abc.ABCMeta):
    def test_mismatched_type_for_options(self) -> None: ...
    def test_infer_backend_from_options(self) -> None: ...
    def test_set_and_get_num_worker_threads(self) -> None: ...
    def test_tensorpipe_set_default_timeout(self) -> None: ...
    def test_tensorpipe_options_throw_on_timedelta_timeout(self) -> None: ...
    def test_rref_get_type_timeout_blocking(self) -> None: ...
    def test_rref_get_type_timeout_non_blocking(self) -> None: ...
    def test_op_with_invalid_args(self) -> None: ...
    def test_rref_proxy_timeout(self) -> None: ...
    def test_send_to_rank_sparse(self) -> None: ...
    def test_self_py_udf_remote_sparse(self) -> None: ...
    def test_self_remote_rref_as_rpc_arg_sparse(self) -> None: ...
    def test_self_remote_rref_as_self_rpc_arg_sparse(self) -> None: ...
    def test_self_remote_rref_as_remote_arg_sparse(self) -> None: ...
    def test_self_remote_rref_as_self_remote_arg_sparse(self) -> None: ...
    def test_world_size_one_sparse(self) -> None: ...
    def test_multi_rpc_sparse(self) -> None: ...
    def test_wait_all_workers_sparse(self) -> None: ...
    def test_wait_all_workers_twice_sparse(self) -> None: ...
    def test_py_sparse_tensors_in_container(self) -> None: ...
    def test_nested_rpc_sparse(self) -> None: ...
    def test_stress_heavy_rpc_sparse(self) -> None: ...
    def test_builtin_remote_ret_sparse(self) -> None: ...
    def test_builtin_remote_self_sparse(self) -> None: ...
    def test_multi_builtin_remote_ret_sparse(self) -> None: ...
    def test_multi_py_udf_remote_sparse(self) -> None: ...
    def test_py_rref_args_sparse(self) -> None: ...
    def test_py_rref_args_user_share_sparse(self) -> None: ...
    def test_py_rpc_rref_args_sparse(self) -> None: ...
    def test_nested_remote_sparse(self) -> None: ...
    def test_nested_rref_sparse(self) -> None: ...
    def test_nested_rref_stress_sparse(self) -> None: ...
    def test_my_parameter_server_sparse(self) -> None: ...
    def test_dynamic_rpc_init_rpc(self) -> None: ...
    def test_dynamic_rpc_new_rank_can_communicated_with_existing_rank(self) -> None: ...
    def test_dynamic_rpc_existing_rank_can_communicate_with_new_rank(self) -> None: ...
    def test_dynamic_rpc_existing_rank_can_communicate_with_new_rank_cuda(self) -> None: ...
    def test_dynamic_rpc_init_rpc_without_rank(self) -> None: ...
    def test_dynamic_and_static_init_rpc_together(self) -> None: ...

class TensorPipeAgentCudaRpcTest(RpcAgentTestFixture, RpcTestCommon, metaclass=abc.ABCMeta):
    def test_device_maps_wrong_worker_name(self) -> None: ...
    def test_device_maps_invalid_max_local_device(self) -> None: ...
    def test_device_maps_invalid_max_remote_device(self) -> None: ...
    def test_device_maps_many_to_one(self) -> None: ...
    def test_device_maps_one_to_many(self) -> None: ...
    def test_device_maps_invalid_min_device(self) -> None: ...
    def test_device_maps_gpu(self) -> None: ...
    def test_device_map_cpu(self) -> None: ...
    def test_device_map_cpu_to_gpu_default(self) -> None: ...
    def test_device_map_cpu_to_gpu_non_default(self) -> None: ...
    def test_device_map_gpu_to_cpu_default(self) -> None: ...
    def test_device_map_gpu_to_cpu_non_default(self) -> None: ...
    def test_device_map_gpu_default(self) -> None: ...
    def test_device_map_gpu_non_default(self) -> None: ...
    def test_device_map_gpu_default_to_non_default(self) -> None: ...
    def test_device_map_gpu_non_default_to_default(self) -> None: ...
    def test_device_map_gpu_mixed_1(self) -> None: ...
    def test_device_map_gpu_mixed_2(self) -> None: ...
    def test_device_map_gpu_mixed_3(self) -> None: ...
    def test_device_map_gpu_mixed_4(self) -> None: ...
    def test_device_map_gpu_mixed_5(self) -> None: ...
    def test_device_map_gpu_mixed_6(self) -> None: ...
    def test_device_map_gpu_mixed_7(self) -> None: ...
    def test_device_map_gpu_mixed_8(self) -> None: ...
    def test_device_map_gpu_mixed_self_1(self) -> None: ...
    def test_device_map_gpu_mixed_self_2(self) -> None: ...
    def test_device_map_gpu_mixed_self_3(self) -> None: ...
    def test_device_map_gpu_mixed_self_4(self) -> None: ...
    def test_device_map_gpu_mixed_self_5(self) -> None: ...
    def test_device_map_gpu_mixed_self_6(self) -> None: ...
    def test_device_map_gpu_mixed_self_7(self) -> None: ...
    def test_device_map_gpu_mixed_self_8(self) -> None: ...
    def test_device_maps_multi_gpu(self) -> None: ...
    def test_device_maps_multi_gpu_self(self) -> None: ...
    def test_device_maps_in_options(self) -> None: ...
    def test_device_maps_return_to_gpu(self) -> None: ...
    def test_device_maps_return_to_gpu_self(self) -> None: ...
    def test_device_maps_missing_config(self) -> None: ...
    def test_device_maps_missing_config_not_timeout(self) -> None: ...
    def test_device_maps_missing_config_loop(self) -> None: ...
    def test_device_maps_missing_config_response(self) -> None: ...
    def test_device_maps_missing_config_response_loop(self) -> None: ...
    def test_device_maps_missing_config_remote(self) -> None: ...
    def test_device_maps_missing_config_remote_response(self) -> None: ...
    def test_device_maps_remote(self) -> None: ...
    def test_custom_stream(self) -> None: ...
    def test_custom_stream_multi(self) -> None: ...
    def test_custom_stream_nested(self) -> None: ...
    def test_custom_stream_nested_multi(self) -> None: ...
    def test_device_mismatch(self) -> None: ...
    def test_rref_to_here_synchronization1(self) -> None: ...
    def test_rref_to_here_synchronization2(self) -> None: ...
    def test_rref_to_here_synchronization3(self) -> None: ...
    def test_rref_to_here_synchronization4(self) -> None: ...
    def test_rref_as_arg_synchronization1(self) -> None: ...
    def test_rref_as_arg_synchronization2(self) -> None: ...
    def test_rref_as_arg_synchronization3(self) -> None: ...
    def test_rref_as_arg_synchronization4(self) -> None: ...
    def test_rref_as_arg_synchronization5(self) -> None: ...
    def test_rref_forward_synchronization1(self) -> None: ...
    def test_rref_forward_synchronization2(self) -> None: ...
    def test_rref_forward_synchronization3(self) -> None: ...
    def test_rref_forward_synchronization4(self) -> None: ...
    def test_owner_rref_forward_synchronization1(self) -> None: ...
    def test_owner_rref_forward_synchronization2(self) -> None: ...
    def test_owner_rref_forward_synchronization3(self) -> None: ...
    def test_owner_rref_forward_synchronization4(self) -> None: ...
    def test_tensor_view_as_return_value(self) -> None: ...
    def test_devices_option_mismatch(self) -> None: ...
    def test_devices_option_mismatch_reverse(self) -> None: ...
    def test_cuda_future_device_as_int(self) -> None: ...
    def test_cuda_future_device_as_str(self) -> None: ...
    def test_cuda_future_device_as_device(self) -> None: ...
    def test_cuda_future_device_not_cuda(self) -> None: ...
    def test_cuda_future_can_extract_cuda_tensor(self): ...
    def test_cuda_future_can_extract_list_with_cuda_tensor(self): ...
    def test_cuda_future_can_extract_custom_class_with_cuda_tensor(self): ...
    def test_cuda_future_callback_changes_devices(self): ...
    def test_cuda_future_value_on_bad_device(self): ...
    def test_async_execution_with_cuda_future(self) -> None: ...
    def test_async_execution_nested_with_cuda_future(self) -> None: ...
    def test_cuda_future_modify_tensor_inplace(self) -> None: ...
    def test_cuda_future_replace_tensor(self) -> None: ...
    def test_rref_with_unpickleable_attributes(self) -> None: ...
    def test_cuda_future_can_extract_cuda_sparse_tensor(self): ...
    def test_cuda_future_can_extract_list_with_cuda_sparse_tensor(self): ...
    def test_cuda_future_can_extract_custom_class_with_cuda_sparse_tensor(self): ...
