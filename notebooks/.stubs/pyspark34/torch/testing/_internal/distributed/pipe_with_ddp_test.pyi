import abc
from torch import nn as nn
from torch.distributed.pipeline.sync import Pipe as Pipe
from torch.nn.parallel import DistributedDataParallel as DistributedDataParallel
from torch.testing._internal.common_distributed import requires_gloo as requires_gloo, requires_nccl as requires_nccl, skip_if_lt_x_gpu as skip_if_lt_x_gpu, skip_if_rocm as skip_if_rocm
from torch.testing._internal.dist_utils import INIT_METHOD_TEMPLATE as INIT_METHOD_TEMPLATE, dist_init as dist_init
from torch.testing._internal.distributed.rpc.rpc_agent_test_fixture import RpcAgentTestFixture as RpcAgentTestFixture

class PipeWithDDPTest(RpcAgentTestFixture, metaclass=abc.ABCMeta):
    @property
    def world_size(self) -> int: ...
    def test_basic_nccl_ckpt_never(self) -> None: ...
    def test_basic_nccl_ckpt_never_find_unused(self) -> None: ...
    def test_basic_nccl_ckpt_always(self) -> None: ...
    def test_basic_nccl_ckpt_except_last(self) -> None: ...
    def test_basic_gloo_ckpt_never(self) -> None: ...
    def test_basic_gloo_ckpt_never_find_unused(self) -> None: ...
    def test_basic_gloo_ckpt_always(self) -> None: ...
    def test_basic_gloo_ckpt_except_last(self) -> None: ...
