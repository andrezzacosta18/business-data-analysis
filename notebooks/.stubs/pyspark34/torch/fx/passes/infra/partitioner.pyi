from _typeshed import Incomplete
from torch.fx.graph_module import GraphModule as GraphModule
from torch.fx.node import Node as Node
from torch.fx.passes.operator_support import OperatorSupportBase as OperatorSupportBase
from torch.fx.passes.utils.fuser_utils import fuse_by_partitions as fuse_by_partitions
from typing import Iterable, List, Sequence

logger: Incomplete

class Partition:
    id: Incomplete
    nodes: Incomplete
    def __init__(self, id: int = None, nodes: Iterable[Node] = None) -> None: ...
    def add_node(self, node: Node): ...
    def remove_node(self, node: Node): ...
    def size(self): ...

class CapabilityBasedPartitioner:
    graph_module: Incomplete
    operator_support: Incomplete
    allows_single_node_partition: Incomplete
    non_compute_ops: Incomplete
    allowed_single_node_partition_ops: Incomplete
    def __init__(self, graph_module: GraphModule, operator_support: OperatorSupportBase, allows_single_node_partition: bool = False, non_compute_ops: Sequence[str] | None = None, allowed_single_node_partition_ops: Sequence[str] | None = None) -> None: ...
    def propose_partitions(self) -> List[Partition]: ...
    def fuse_partitions(self, partitions: List[Partition]) -> GraphModule: ...
    def remove_bookend_non_compute_ops(self, partitions: List[Partition]): ...
    def partition_and_fuse(self) -> GraphModule: ...
