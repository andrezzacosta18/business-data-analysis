import torch
from dataclasses import dataclass
from enum import Enum
from torch.distributed._shard.metadata import ShardMetadata as ShardMetadata
from typing import List

class MEM_FORMAT_ENCODING(Enum):
    TORCH_CONTIGUOUS_FORMAT: int
    TORCH_CHANNELS_LAST: int
    TORCH_PRESERVE_FORMAT: int

@dataclass
class TensorProperties:
    """ Properties used to create :class:`Tensor` """
    dtype: torch.dtype = ...
    layout: torch.layout = ...
    requires_grad: bool = ...
    memory_format: torch.memory_format = ...
    pin_memory: bool = ...
    @staticmethod
    def create_from_tensor(tensor: torch.Tensor) -> TensorProperties: ...
    def __init__(self, dtype, layout, requires_grad, memory_format, pin_memory) -> None: ...

@dataclass
class ShardedTensorMetadata:
    """
    Represents metadata for :class:`ShardedTensor`
    """
    shards_metadata: List[ShardMetadata] = ...
    size: torch.Size = ...
    tensor_properties: TensorProperties = ...
    def __init__(self, shards_metadata, size, tensor_properties) -> None: ...
