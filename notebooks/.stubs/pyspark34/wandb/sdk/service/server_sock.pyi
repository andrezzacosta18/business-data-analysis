import socket
import threading
from ..interface.interface_relay import InterfaceRelay as InterfaceRelay
from ..lib import tracelog as tracelog
from ..lib.sock_client import SockClient as SockClient, SockClientClosedError as SockClientClosedError
from .streams import StreamMux as StreamMux
from threading import Event
from typing import Any
from wandb.proto import wandb_server_pb2 as spb
from wandb.sdk.internal.settings_static import SettingsStatic as SettingsStatic

class ClientDict:
    def __init__(self) -> None: ...
    def get_client(self, client_id: str) -> SockClient | None: ...
    def add_client(self, client: SockClient) -> None: ...
    def del_client(self, client: SockClient) -> None: ...

class SockServerInterfaceReaderThread(threading.Thread):
    name: str
    def __init__(self, clients: ClientDict, iface: InterfaceRelay, stopped: Event) -> None: ...
    def run(self) -> None: ...

class SockServerReadThread(threading.Thread):
    name: str
    def __init__(self, conn: socket.socket, mux: StreamMux, clients: ClientDict) -> None: ...
    def run(self) -> None: ...
    def stop(self) -> None: ...
    def server_inform_init(self, sreq: spb.ServerRequest) -> None: ...
    def server_inform_start(self, sreq: spb.ServerRequest) -> None: ...
    def server_inform_attach(self, sreq: spb.ServerRequest) -> None: ...
    def server_record_communicate(self, sreq: spb.ServerRequest) -> None: ...
    def server_record_publish(self, sreq: spb.ServerRequest) -> None: ...
    def server_inform_finish(self, sreq: spb.ServerRequest) -> None: ...
    def server_inform_teardown(self, sreq: spb.ServerRequest) -> None: ...

class SockAcceptThread(threading.Thread):
    name: str
    def __init__(self, sock: socket.socket, mux: StreamMux) -> None: ...
    def run(self) -> None: ...

class DebugThread(threading.Thread):
    daemon: bool
    name: str
    def __init__(self, mux: StreamMux) -> None: ...
    def run(self) -> None: ...

class SocketServer:
    def __init__(self, mux: Any, address: str, port: int) -> None: ...
    @property
    def port(self) -> int: ...
    def start(self) -> None: ...
    def stop(self) -> None: ...
