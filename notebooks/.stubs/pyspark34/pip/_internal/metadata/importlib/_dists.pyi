import abc
import importlib.metadata
import pathlib
import zipfile
from ._compat import BasePath as BasePath, get_dist_name as get_dist_name
from _typeshed import Incomplete
from pip._internal.exceptions import InvalidWheel as InvalidWheel, UnsupportedWheel as UnsupportedWheel
from pip._internal.metadata.base import BaseDistribution as BaseDistribution, BaseEntryPoint as BaseEntryPoint, DistributionVersion as DistributionVersion, InfoPath as InfoPath, Wheel as Wheel
from pip._internal.utils.misc import normalize_path as normalize_path
from pip._internal.utils.temp_dir import TempDirectory as TempDirectory
from pip._internal.utils.wheel import parse_wheel as parse_wheel, read_wheel_metadata_file as read_wheel_metadata_file
from pip._vendor.packaging.requirements import Requirement as Requirement
from pip._vendor.packaging.utils import NormalizedName as NormalizedName, canonicalize_name as canonicalize_name
from typing import Collection, Iterable, Iterator, Mapping

class WheelDistribution(importlib.metadata.Distribution, metaclass=abc.ABCMeta):
    '''An ``importlib.metadata.Distribution`` read from a wheel.

    Although ``importlib.metadata.PathDistribution`` accepts ``zipfile.Path``,
    its implementation is too "lazy" for pip\'s needs (we can\'t keep the ZipFile
    handle open for the entire lifetime of the distribution object).

    This implementation eagerly reads the entire metadata directory into the
    memory instead, and operates from that.
    '''
    info_location: Incomplete
    def __init__(self, files: Mapping[pathlib.PurePosixPath, bytes], info_location: pathlib.PurePosixPath) -> None: ...
    @classmethod
    def from_zipfile(cls, zf: zipfile.ZipFile, name: str, location: str) -> WheelDistribution: ...
    def iterdir(self, path: InfoPath) -> Iterator[pathlib.PurePosixPath]: ...
    def read_text(self, filename: str) -> str | None: ...

class Distribution(BaseDistribution):
    def __init__(self, dist: importlib.metadata.Distribution, info_location: BasePath | None, installed_location: BasePath | None) -> None: ...
    @classmethod
    def from_directory(cls, directory: str) -> BaseDistribution: ...
    @classmethod
    def from_metadata_file_contents(cls, metadata_contents: bytes, filename: str, project_name: str) -> BaseDistribution: ...
    @classmethod
    def from_wheel(cls, wheel: Wheel, name: str) -> BaseDistribution: ...
    @property
    def location(self) -> str | None: ...
    @property
    def info_location(self) -> str | None: ...
    @property
    def installed_location(self) -> str | None: ...
    @property
    def canonical_name(self) -> NormalizedName: ...
    @property
    def version(self) -> DistributionVersion: ...
    def is_file(self, path: InfoPath) -> bool: ...
    def iter_distutils_script_names(self) -> Iterator[str]: ...
    def read_text(self, path: InfoPath) -> str: ...
    def iter_entry_points(self) -> Iterable[BaseEntryPoint]: ...
    def iter_provided_extras(self) -> Iterable[str]: ...
    def is_extra_provided(self, extra: str) -> bool: ...
    def iter_dependencies(self, extras: Collection[str] = ()) -> Iterable[Requirement]: ...
