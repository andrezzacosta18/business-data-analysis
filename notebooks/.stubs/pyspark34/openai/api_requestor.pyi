import aiohttp
import requests
from _typeshed import Incomplete
from openai import error as error, util as util, version as version
from openai.openai_response import OpenAIResponse as OpenAIResponse
from openai.util import ApiType as ApiType
from typing import AsyncGenerator, AsyncIterator, Dict, Iterator, Literal, Tuple, overload

TIMEOUT_SECS: int
MAX_SESSION_LIFETIME_SECS: int
MAX_CONNECTION_RETRIES: int

def parse_stream_helper(line: bytes) -> str | None: ...
def parse_stream(rbody: Iterator[bytes]) -> Iterator[str]: ...
async def parse_stream_async(rbody: aiohttp.StreamReader): ...

class APIRequestor:
    api_base: Incomplete
    api_key: Incomplete
    api_type: Incomplete
    api_version: Incomplete
    organization: Incomplete
    def __init__(self, key: Incomplete | None = None, api_base: Incomplete | None = None, api_type: Incomplete | None = None, api_version: Incomplete | None = None, organization: Incomplete | None = None) -> None: ...
    @classmethod
    def format_app_info(cls, info): ...
    @overload
    def request(self, method, url, params, headers, files, stream: Literal[True], request_id: str | None = ..., request_timeout: float | Tuple[float, float] | None = ...) -> Tuple[Iterator[OpenAIResponse], bool, str]: ...
    @overload
    def request(self, method, url, params=..., headers=..., files=..., *, stream: Literal[True], request_id: str | None = ..., request_timeout: float | Tuple[float, float] | None = ...) -> Tuple[Iterator[OpenAIResponse], bool, str]: ...
    @overload
    def request(self, method, url, params=..., headers=..., files=..., stream: Literal[False] = ..., request_id: str | None = ..., request_timeout: float | Tuple[float, float] | None = ...) -> Tuple[OpenAIResponse, bool, str]: ...
    @overload
    def request(self, method, url, params=..., headers=..., files=..., stream: bool = ..., request_id: str | None = ..., request_timeout: float | Tuple[float, float] | None = ...) -> Tuple[OpenAIResponse | Iterator[OpenAIResponse], bool, str]: ...
    @overload
    async def arequest(self, method, url, params, headers, files, stream: Literal[True], request_id: str | None = ..., request_timeout: float | Tuple[float, float] | None = ...) -> Tuple[AsyncGenerator[OpenAIResponse, None], bool, str]: ...
    @overload
    async def arequest(self, method, url, params=..., headers=..., files=..., *, stream: Literal[True], request_id: str | None = ..., request_timeout: float | Tuple[float, float] | None = ...) -> Tuple[AsyncGenerator[OpenAIResponse, None], bool, str]: ...
    @overload
    async def arequest(self, method, url, params=..., headers=..., files=..., stream: Literal[False] = ..., request_id: str | None = ..., request_timeout: float | Tuple[float, float] | None = ...) -> Tuple[OpenAIResponse, bool, str]: ...
    @overload
    async def arequest(self, method, url, params=..., headers=..., files=..., stream: bool = ..., request_id: str | None = ..., request_timeout: float | Tuple[float, float] | None = ...) -> Tuple[OpenAIResponse | AsyncGenerator[OpenAIResponse, None], bool, str]: ...
    def handle_error_response(self, rbody, rcode, resp, rheaders, stream_error: bool = False): ...
    def request_headers(self, method: str, extra, request_id: str | None) -> Dict[str, str]: ...
    def request_raw(self, method, url, *, params: Incomplete | None = None, supplied_headers: Dict[str, str] | None = None, files: Incomplete | None = None, stream: bool = False, request_id: str | None = None, request_timeout: float | Tuple[float, float] | None = None) -> requests.Response: ...
    async def arequest_raw(self, method, url, session, *, params: Incomplete | None = None, supplied_headers: Dict[str, str] | None = None, files: Incomplete | None = None, request_id: str | None = None, request_timeout: float | Tuple[float, float] | None = None) -> aiohttp.ClientResponse: ...

async def aiohttp_session() -> AsyncIterator[aiohttp.ClientSession]: ...
