import chromadb.db.base as base
import pypika
from chromadb.config import Settings as Settings, System as System
from chromadb.db.impl.sqlite_pool import Connection as Connection, LockPool as LockPool, PerThreadPool as PerThreadPool, Pool as Pool
from chromadb.db.migrations import MigratableDB as MigratableDB, Migration as Migration
from chromadb.db.mixins.embeddings_queue import SqlEmbeddingsQueue as SqlEmbeddingsQueue
from chromadb.db.mixins.sysdb import SqlSysDB as SqlSysDB
from chromadb.utils.delete_file import delete_file as delete_file
from importlib_resources.abc import Traversable as Traversable
from threading import local
from types import TracebackType
from typing import Any, Sequence, Type
from typing_extensions import Literal
from uuid import UUID

class TxWrapper(base.TxWrapper):
    def __init__(self, conn_pool: Pool, stack: local) -> None: ...
    def __enter__(self) -> base.Cursor: ...
    def __exit__(self, exc_type: Type[BaseException] | None, exc_value: BaseException | None, traceback: TracebackType | None) -> Literal[False]: ...

class SqliteDB(MigratableDB, SqlEmbeddingsQueue, SqlSysDB):
    def __init__(self, system: System) -> None: ...
    def start(self) -> None: ...
    def stop(self) -> None: ...
    @staticmethod
    def querybuilder() -> Type[pypika.Query]: ...
    @staticmethod
    def parameter_format() -> str: ...
    @staticmethod
    def migration_scope() -> str: ...
    def migration_dirs(self) -> Sequence[Traversable]: ...
    def tx(self) -> TxWrapper: ...
    def reset_state(self) -> None: ...
    def setup_migrations(self) -> None: ...
    def migrations_initialized(self) -> bool: ...
    def db_migrations(self, dir: Traversable) -> Sequence[Migration]: ...
    def apply_migration(self, cur: base.Cursor, migration: Migration) -> None: ...
    @staticmethod
    def uuid_from_db(value: Any | None) -> UUID | None: ...
    @staticmethod
    def uuid_to_db(uuid: UUID | None) -> Any | None: ...
    @staticmethod
    def unique_constraint_error() -> Type[BaseException]: ...
