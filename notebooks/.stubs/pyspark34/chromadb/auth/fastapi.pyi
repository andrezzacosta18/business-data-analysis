from _typeshed import Incomplete
from chromadb.auth import AuthInfoType as AuthInfoType, ChromaAuthMiddleware as ChromaAuthMiddleware, ServerAuthProvider as ServerAuthProvider, ServerAuthenticationRequest as ServerAuthenticationRequest, ServerAuthenticationResponse as ServerAuthenticationResponse
from chromadb.auth.registry import resolve_provider as resolve_provider
from chromadb.config import System as System
from starlette.middleware.base import BaseHTTPMiddleware, RequestResponseEndpoint as RequestResponseEndpoint
from starlette.requests import Request as Request
from starlette.responses import Response as Response
from starlette.types import ASGIApp as ASGIApp
from typing import Any

logger: Incomplete

class FastAPIServerAuthenticationRequest(ServerAuthenticationRequest[str | None]):
    def __init__(self, request: Request) -> None: ...
    def get_auth_info(self, auth_info_type: AuthInfoType, auth_info_id: str | None = None) -> str | None: ...

class FastAPIServerAuthenticationResponse(ServerAuthenticationResponse):
    def __init__(self, auth_success: bool) -> None: ...
    def success(self) -> bool: ...

class FastAPIChromaAuthMiddleware(ChromaAuthMiddleware):
    def __init__(self, system: System) -> None: ...
    def authenticate(self, request: ServerAuthenticationRequest[Any]) -> ServerAuthenticationResponse | None: ...
    def ignore_operation(self, verb: str, path: str) -> bool: ...
    def instrument_server(self, app: ASGIApp) -> None: ...

class FastAPIChromaAuthMiddlewareWrapper(BaseHTTPMiddleware):
    def __init__(self, app: ASGIApp, auth_middleware: FastAPIChromaAuthMiddleware) -> None: ...
    async def dispatch(self, request: Request, call_next: RequestResponseEndpoint) -> Response: ...
