import chromadb.server
import fastapi
from _typeshed import Incomplete
from chromadb.api.models.Collection import Collection as Collection
from chromadb.api.types import GetResult as GetResult, QueryResult as QueryResult
from chromadb.auth.fastapi import FastAPIChromaAuthMiddleware as FastAPIChromaAuthMiddleware, FastAPIChromaAuthMiddlewareWrapper as FastAPIChromaAuthMiddlewareWrapper
from chromadb.config import Settings as Settings
from chromadb.errors import ChromaError as ChromaError, InvalidDimensionException as InvalidDimensionException, InvalidUUIDError as InvalidUUIDError
from chromadb.server.fastapi.types import AddEmbedding as AddEmbedding, CreateCollection as CreateCollection, DeleteEmbedding as DeleteEmbedding, GetEmbedding as GetEmbedding, QueryEmbedding as QueryEmbedding, UpdateCollection as UpdateCollection, UpdateEmbedding as UpdateEmbedding
from chromadb.telemetry import ServerContext as ServerContext, Telemetry as Telemetry
from fastapi import FastAPI as _FastAPI, Response as Response
from starlette.requests import Request as Request
from typing import Any, Callable, Dict, List, Sequence
from uuid import UUID

logger: Incomplete

def use_route_names_as_operation_ids(app: _FastAPI) -> None:
    """
    Simplify operation IDs so that generated API clients have simpler function
    names.
    Should be called only after all routes have been added.
    """
async def catch_exceptions_middleware(request: Request, call_next: Callable[[Request], Any]) -> Response: ...

class ChromaAPIRouter(fastapi.APIRouter):
    def add_api_route(self, path: str, *args: Any, **kwargs: Any) -> None: ...

class FastAPI(chromadb.server.Server):
    router: Incomplete
    def __init__(self, settings: Settings) -> None: ...
    def app(self) -> fastapi.FastAPI: ...
    def root(self) -> Dict[str, int]: ...
    def heartbeat(self) -> Dict[str, int]: ...
    def version(self) -> str: ...
    def list_collections(self) -> Sequence[Collection]: ...
    def create_collection(self, collection: CreateCollection) -> Collection: ...
    def get_collection(self, collection_name: str) -> Collection: ...
    def update_collection(self, collection_id: str, collection: UpdateCollection) -> None: ...
    def delete_collection(self, collection_name: str) -> None: ...
    def add(self, collection_id: str, add: AddEmbedding) -> None: ...
    def update(self, collection_id: str, add: UpdateEmbedding) -> None: ...
    def upsert(self, collection_id: str, upsert: AddEmbedding) -> None: ...
    def get(self, collection_id: str, get: GetEmbedding) -> GetResult: ...
    def delete(self, collection_id: str, delete: DeleteEmbedding) -> List[UUID]: ...
    def count(self, collection_id: str) -> int: ...
    def reset(self) -> bool: ...
    def get_nearest_neighbors(self, collection_id: str, query: QueryEmbedding) -> QueryResult: ...
    def pre_flight_checks(self) -> Dict[str, Any]: ...
