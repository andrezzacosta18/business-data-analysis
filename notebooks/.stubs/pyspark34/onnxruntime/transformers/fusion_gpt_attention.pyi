from _typeshed import Incomplete
from fusion_base import Fusion
from onnx_model import OnnxModel as OnnxModel

logger: Incomplete

class FusionGptAttentionPastBase(Fusion):
    """Base class for GPT Attention Fusion with past state"""
    num_heads: Incomplete
    utils: Incomplete
    casted_attention_mask: Incomplete
    mask_filter_value: Incomplete
    def __init__(self, model: OnnxModel, num_heads: int) -> None: ...
    def match_past_pattern_1(self, concat_k, concat_v, output_name_to_node): ...
    def match_past_pattern_2(self, concat_k, concat_v, output_name_to_node): ...
    def match_present(self, concat_v, input_name_to_nodes): ...
    def cast_attention_mask(self, input_name): ...

class FusionGptAttention(FusionGptAttentionPastBase):
    """
    Fuse GPT-2 Attention with past state subgraph into one Attention node.
    """
    def __init__(self, model: OnnxModel, num_heads: int) -> None: ...
    def create_attention_node(self, fc_weight, fc_bias, gemm_qkv, past, present, input, output, mask, is_unidirectional) -> None: ...
    mask_filter_value: Incomplete
    prune_graph: bool
    def fuse(self, normalize_node, input_name_to_nodes, output_name_to_node) -> None: ...
